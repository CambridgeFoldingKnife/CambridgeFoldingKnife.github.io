import{_ as e,c as t,d as l,e as s,f as a,b as i,w as c,r as o,o as u}from"./app-DyGs7pMe.js";const r={};function d(k,n){const p=o("RouteLink");return u(),t("div",null,[n[3]||(n[3]=l(`<h1 id="ä¸Šä¸‹æ–‡ç®¡ç†å™¨" tabindex="-1"><a class="header-anchor" href="#ä¸Šä¸‹æ–‡ç®¡ç†å™¨"><span>ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span></a></h1><blockquote><p>æŒæ¡Pythonä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œä¼˜é›…åœ°ç®¡ç†èµ„æº</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>ç†è§£ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„æ¦‚å¿µ</li><li>æŒæ¡ with è¯­å¥çš„ä½¿ç”¨</li><li>å­¦ä¼šåˆ›å»ºè‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨</li><li>æŒæ¡ contextlib æ¨¡å—</li></ul><h2 id="_1-ä¸Šä¸‹æ–‡ç®¡ç†å™¨åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#_1-ä¸Šä¸‹æ–‡ç®¡ç†å™¨åŸºç¡€"><span>1. ä¸Šä¸‹æ–‡ç®¡ç†å™¨åŸºç¡€</span></a></h2><h3 id="_1-1-with-è¯­å¥" tabindex="-1"><a class="header-anchor" href="#_1-1-with-è¯­å¥"><span>1.1 with è¯­å¥</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># ä¸ä½¿ç”¨ with</span></span>
<span class="line"><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;test.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">    content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">finally</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨ withï¼ˆæ¨èï¼‰</span></span>
<span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;test.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span></span>
<span class="line">    content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># è‡ªåŠ¨å…³é—­æ–‡ä»¶</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#_1-2-å·¥ä½œåŸç†"><span>1.2 å·¥ä½œåŸç†</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># with è¯­å¥ä¼šè‡ªåŠ¨è°ƒç”¨ï¼š</span></span>
<span class="line"><span class="token comment"># 1. __enter__() - è¿›å…¥æ—¶</span></span>
<span class="line"><span class="token comment"># 2. __exit__()  - é€€å‡ºæ—¶</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">MyContext</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;è¿›å…¥ä¸Šä¸‹æ–‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> self</span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;é€€å‡ºä¸Šä¸‹æ–‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">False</span>  <span class="token comment"># ä¸æŠ‘åˆ¶å¼‚å¸¸</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">with</span> MyContext<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ctx<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;æ‰§è¡Œä»£ç &#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨" tabindex="-1"><a class="header-anchor" href="#_2-è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨"><span>2. è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span></a></h2><h3 id="_2-1-ç±»æ–¹å¼å®ç°" tabindex="-1"><a class="header-anchor" href="#_2-1-ç±»æ–¹å¼å®ç°"><span>2.1 ç±»æ–¹å¼å®ç°</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">DatabaseConnection</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;æ•°æ®åº“è¿æ¥ç®¡ç†å™¨&quot;&quot;&quot;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>host <span class="token operator">=</span> host</span>
<span class="line">        self<span class="token punctuation">.</span>port <span class="token operator">=</span> port</span>
<span class="line">        self<span class="token punctuation">.</span>connection <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;è¿æ¥æ•°æ®åº“: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>host<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>port<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>connection <span class="token operator">=</span> self<span class="token punctuation">.</span>_connect<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>connection</span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> self<span class="token punctuation">.</span>connection<span class="token punctuation">:</span></span>
<span class="line">            self<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;å…³é—­æ•°æ®åº“è¿æ¥&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> exc_type <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;å‘ç”Ÿå¼‚å¸¸: </span><span class="token interpolation"><span class="token punctuation">{</span>exc_type<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>exc_val<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">False</span>  <span class="token comment"># ä¸æŠ‘åˆ¶å¼‚å¸¸</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># æ¨¡æ‹Ÿè¿æ¥</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&#39;connected&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line"><span class="token keyword">with</span> DatabaseConnection<span class="token punctuation">(</span><span class="token string">&#39;localhost&#39;</span><span class="token punctuation">,</span> <span class="token number">3306</span><span class="token punctuation">)</span> <span class="token keyword">as</span> conn<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;ä½¿ç”¨è¿æ¥: </span><span class="token interpolation"><span class="token punctuation">{</span>conn<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-æ–‡ä»¶å†™å…¥ç®¡ç†å™¨" tabindex="-1"><a class="header-anchor" href="#_2-2-æ–‡ä»¶å†™å…¥ç®¡ç†å™¨"><span>2.2 æ–‡ä»¶å†™å…¥ç®¡ç†å™¨</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">FileWriter</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;æ–‡ä»¶å†™å…¥ç®¡ç†å™¨&quot;&quot;&quot;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename</span>
<span class="line">        self<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">file</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> self<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">:</span></span>
<span class="line">            self<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">False</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">with</span> FileWriter<span class="token punctuation">(</span><span class="token string">&#39;output.txt&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&#39;Hello, World!&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-contextlib-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_3-contextlib-æ¨¡å—"><span>3. contextlib æ¨¡å—</span></a></h2><h3 id="_3-1-contextmanager-è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#_3-1-contextmanager-è£…é¥°å™¨"><span>3.1 contextmanager è£…é¥°å™¨</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@contextmanager</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">file_manager</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;æ–‡ä»¶ç®¡ç†å™¨&quot;&quot;&quot;</span></span>
<span class="line">    <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">yield</span> <span class="token builtin">file</span>  <span class="token comment"># yield å‰é¢æ˜¯ __enter__</span></span>
<span class="line">    <span class="token keyword">finally</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># finally æ˜¯ __exit__</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line"><span class="token keyword">with</span> file_manager<span class="token punctuation">(</span><span class="token string">&#39;test.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&#39;ä½¿ç”¨ contextmanager&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-æ•°æ®åº“äº‹åŠ¡ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_3-2-æ•°æ®åº“äº‹åŠ¡ç®¡ç†"><span>3.2 æ•°æ®åº“äº‹åŠ¡ç®¡ç†</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@contextmanager</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">transaction</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;æ•°æ®åº“äº‹åŠ¡ç®¡ç†å™¨&quot;&quot;&quot;</span></span>
<span class="line">    cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">yield</span> cursor</span>
<span class="line">        connection<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æäº¤äº‹åŠ¡</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;äº‹åŠ¡æäº¤æˆåŠŸ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">        connection<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å›æ»šäº‹åŠ¡</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;äº‹åŠ¡å›æ»š: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">raise</span></span>
<span class="line">    <span class="token keyword">finally</span><span class="token punctuation">:</span></span>
<span class="line">        cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line"><span class="token keyword">with</span> transaction<span class="token punctuation">(</span>db_connection<span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span></span>
<span class="line">    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&#39;INSERT INTO users VALUES (...)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&#39;UPDATE accounts SET ...&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-è®¡æ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#_3-3-è®¡æ—¶å™¨"><span>3.3 è®¡æ—¶å™¨</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@contextmanager</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;è®¡æ—¶ä¸Šä¸‹æ–‡ç®¡ç†å™¨&quot;&quot;&quot;</span></span>
<span class="line">    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">yield</span></span>
<span class="line">    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> è€—æ—¶: </span><span class="token interpolation"><span class="token punctuation">{</span>end <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">ç§’&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line"><span class="token keyword">with</span> timer<span class="token punctuation">(</span><span class="token string">&#39;æ•°æ®å¤„ç†&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># æ‰§è¡Œè€—æ—¶æ“ä½œ</span></span>
<span class="line">    <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-åµŒå¥—ä¸Šä¸‹æ–‡ç®¡ç†å™¨" tabindex="-1"><a class="header-anchor" href="#_4-åµŒå¥—ä¸Šä¸‹æ–‡ç®¡ç†å™¨"><span>4. åµŒå¥—ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span></a></h2><h3 id="_4-1-å¤šä¸ª-with-è¯­å¥" tabindex="-1"><a class="header-anchor" href="#_4-1-å¤šä¸ª-with-è¯­å¥"><span>4.1 å¤šä¸ª with è¯­å¥</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># æ–¹å¼1ï¼šåµŒå¥—</span></span>
<span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;input.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> in_file<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;output.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out_file<span class="token punctuation">:</span></span>
<span class="line">        out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>in_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ–¹å¼2ï¼šä¸€è¡Œï¼ˆPython 3.1+ï¼‰</span></span>
<span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;input.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> in_file<span class="token punctuation">,</span> \\</span>
<span class="line">     <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;output.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out_file<span class="token punctuation">:</span></span>
<span class="line">    out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>in_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-exitstack" tabindex="-1"><a class="header-anchor" href="#_4-2-exitstack"><span>4.2 ExitStack</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> ExitStack</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">process_files</span><span class="token punctuation">(</span>filenames<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶&quot;&quot;&quot;</span></span>
<span class="line">    <span class="token keyword">with</span> ExitStack<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> stack<span class="token punctuation">:</span></span>
<span class="line">        files <span class="token operator">=</span> <span class="token punctuation">[</span>stack<span class="token punctuation">.</span>enter_context<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>fname<span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> </span>
<span class="line">                 <span class="token keyword">for</span> fname <span class="token keyword">in</span> filenames<span class="token punctuation">]</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">for</span> f <span class="token keyword">in</span> files<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">process_files<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;file1.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;file2.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;file3.txt&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-å®æˆ˜æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_5-å®æˆ˜æ¡ˆä¾‹"><span>5. å®æˆ˜æ¡ˆä¾‹</span></a></h2><h3 id="æ¡ˆä¾‹1-ä¸´æ—¶ç›®å½•" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹1-ä¸´æ—¶ç›®å½•"><span>æ¡ˆä¾‹1ï¼šä¸´æ—¶ç›®å½•</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> tempfile</span>
<span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@contextmanager</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">temporary_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;ä¸´æ—¶ç›®å½•ç®¡ç†å™¨&quot;&quot;&quot;</span></span>
<span class="line">    temp_dir <span class="token operator">=</span> tempfile<span class="token punctuation">.</span>mkdtemp<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;åˆ›å»ºä¸´æ—¶ç›®å½•: </span><span class="token interpolation"><span class="token punctuation">{</span>temp_dir<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">yield</span> temp_dir</span>
<span class="line">    <span class="token keyword">finally</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">import</span> shutil</span>
<span class="line">        shutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span>temp_dir<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;åˆ é™¤ä¸´æ—¶ç›®å½•: </span><span class="token interpolation"><span class="token punctuation">{</span>temp_dir<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line"><span class="token keyword">with</span> temporary_directory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> temp_dir<span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># åœ¨ä¸´æ—¶ç›®å½•ä¸­å·¥ä½œ</span></span>
<span class="line">    file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp_dir<span class="token punctuation">,</span> <span class="token string">&#39;temp.txt&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&#39;ä¸´æ—¶æ•°æ®&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¡ˆä¾‹2-çŠ¶æ€åˆ‡æ¢" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹2-çŠ¶æ€åˆ‡æ¢"><span>æ¡ˆä¾‹2ï¼šçŠ¶æ€åˆ‡æ¢</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@contextmanager</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">change_dir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;ä¸´æ—¶åˆ‡æ¢ç›®å½•&quot;&quot;&quot;</span></span>
<span class="line">    old_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">yield</span></span>
<span class="line">    <span class="token keyword">finally</span><span class="token punctuation">:</span></span>
<span class="line">        os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>old_dir<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;å½“å‰ç›®å½•: </span><span class="token interpolation"><span class="token punctuation">{</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">with</span> change_dir<span class="token punctuation">(</span><span class="token string">&#39;/tmp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;ä¸´æ—¶ç›®å½•: </span><span class="token interpolation"><span class="token punctuation">{</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;æ¢å¤ç›®å½•: </span><span class="token interpolation"><span class="token punctuation">{</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¡ˆä¾‹3-èµ„æºé”" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹3-èµ„æºé”"><span>æ¡ˆä¾‹3ï¼šèµ„æºé”</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> threading</span>
<span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@contextmanager</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">acquire_lock</span><span class="token punctuation">(</span>lock<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;é”ç®¡ç†å™¨&quot;&quot;&quot;</span></span>
<span class="line">    lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;è·å–é”&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">yield</span></span>
<span class="line">    <span class="token keyword">finally</span><span class="token punctuation">:</span></span>
<span class="line">        lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;é‡Šæ”¾é”&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line">lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">with</span> acquire_lock<span class="token punctuation">(</span>lock<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># æ‰§è¡Œéœ€è¦åŒæ­¥çš„ä»£ç </span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;æ‰§è¡ŒåŒæ­¥æ“ä½œ&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-å¼‚å¸¸å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_6-å¼‚å¸¸å¤„ç†"><span>6. å¼‚å¸¸å¤„ç†</span></a></h2><h3 id="_6-1-æŠ‘åˆ¶å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_6-1-æŠ‘åˆ¶å¼‚å¸¸"><span>6.1 æŠ‘åˆ¶å¼‚å¸¸</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">SuppressError</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;æŠ‘åˆ¶ç‰¹å®šå¼‚å¸¸&quot;&quot;&quot;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>exceptions<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>exceptions <span class="token operator">=</span> exceptions</span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> self</span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> exc_type <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token builtin">issubclass</span><span class="token punctuation">(</span>exc_type<span class="token punctuation">,</span> self<span class="token punctuation">.</span>exceptions<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;æŠ‘åˆ¶å¼‚å¸¸: </span><span class="token interpolation"><span class="token punctuation">{</span>exc_type<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword">return</span> <span class="token boolean">True</span>  <span class="token comment"># æŠ‘åˆ¶å¼‚å¸¸</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">False</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line"><span class="token keyword">with</span> SuppressError<span class="token punctuation">(</span>ValueError<span class="token punctuation">,</span> TypeError<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># å¼‚å¸¸è¢«æŠ‘åˆ¶</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;ç»§ç»­æ‰§è¡Œ&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-2-suppress-ä¸Šä¸‹æ–‡ç®¡ç†å™¨" tabindex="-1"><a class="header-anchor" href="#_6-2-suppress-ä¸Šä¸‹æ–‡ç®¡ç†å™¨"><span>6.2 suppress ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> suppress</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¿½ç•¥ç‰¹å®šå¼‚å¸¸</span></span>
<span class="line"><span class="token keyword">with</span> suppress<span class="token punctuation">(</span>FileNotFoundError<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">&#39;nonexistent_file.txt&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç­‰ä»·äº</span></span>
<span class="line"><span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">&#39;nonexistent_file.txt&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">pass</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-æœ€ä½³å®è·µ" tabindex="-1"><a class="header-anchor" href="#_7-æœ€ä½³å®è·µ"><span>7. æœ€ä½³å®è·µ</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># âœ… ä½¿ç”¨ with ç®¡ç†èµ„æº</span></span>
<span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;file.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># âœ… ä½¿ç”¨ contextmanager ç®€åŒ–ä»£ç </span></span>
<span class="line"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@contextmanager</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">managed_resource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    resource <span class="token operator">=</span> acquire_resource<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">yield</span> resource</span>
<span class="line">    <span class="token keyword">finally</span><span class="token punctuation">:</span></span>
<span class="line">        release_resource<span class="token punctuation">(</span>resource<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># âœ… å¼‚å¸¸å¤„ç†</span></span>
<span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;file.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;è¯»å–å¤±è´¥: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“-ç»ƒä¹ é¢˜" tabindex="-1"><a class="header-anchor" href="#ğŸ“-ç»ƒä¹ é¢˜"><span>ğŸ“ ç»ƒä¹ é¢˜</span></a></h2><ol><li>åˆ›å»ºä¸€ä¸ªè®¡æ—¶ä¸Šä¸‹æ–‡ç®¡ç†å™¨</li><li>å®ç°ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ç®¡ç†å™¨</li><li>ç¼–å†™ä¸€ä¸ªä¸´æ—¶ç¯å¢ƒå˜é‡ç®¡ç†å™¨</li></ol><hr>`,43)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),i(p,{to:"/tutorials/python-ai/python/%E7%AC%AC03%E7%AB%A0-%E8%BF%9B%E9%98%B6%E7%BC%96%E7%A8%8B/05-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html"},{default:c(()=>[...n[0]||(n[0]=[a("æ­£åˆ™è¡¨è¾¾å¼",-1)])]),_:1})])])}const m=e(r,[["render",d]]),b=JSON.parse('{"path":"/tutorials/python-ai/python/di03zhang-jinjiebiancheng/04-shangxiawenguanliqi.html","title":"ä¸Šä¸‹æ–‡ç®¡ç†å™¨","lang":"zh-CN","frontmatter":{"title":"ä¸Šä¸‹æ–‡ç®¡ç†å™¨"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. ä¸Šä¸‹æ–‡ç®¡ç†å™¨åŸºç¡€","slug":"_1-ä¸Šä¸‹æ–‡ç®¡ç†å™¨åŸºç¡€","link":"#_1-ä¸Šä¸‹æ–‡ç®¡ç†å™¨åŸºç¡€","children":[{"level":3,"title":"1.1 with è¯­å¥","slug":"_1-1-with-è¯­å¥","link":"#_1-1-with-è¯­å¥","children":[]},{"level":3,"title":"1.2 å·¥ä½œåŸç†","slug":"_1-2-å·¥ä½œåŸç†","link":"#_1-2-å·¥ä½œåŸç†","children":[]}]},{"level":2,"title":"2. è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨","slug":"_2-è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨","link":"#_2-è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨","children":[{"level":3,"title":"2.1 ç±»æ–¹å¼å®ç°","slug":"_2-1-ç±»æ–¹å¼å®ç°","link":"#_2-1-ç±»æ–¹å¼å®ç°","children":[]},{"level":3,"title":"2.2 æ–‡ä»¶å†™å…¥ç®¡ç†å™¨","slug":"_2-2-æ–‡ä»¶å†™å…¥ç®¡ç†å™¨","link":"#_2-2-æ–‡ä»¶å†™å…¥ç®¡ç†å™¨","children":[]}]},{"level":2,"title":"3. contextlib æ¨¡å—","slug":"_3-contextlib-æ¨¡å—","link":"#_3-contextlib-æ¨¡å—","children":[{"level":3,"title":"3.1 contextmanager è£…é¥°å™¨","slug":"_3-1-contextmanager-è£…é¥°å™¨","link":"#_3-1-contextmanager-è£…é¥°å™¨","children":[]},{"level":3,"title":"3.2 æ•°æ®åº“äº‹åŠ¡ç®¡ç†","slug":"_3-2-æ•°æ®åº“äº‹åŠ¡ç®¡ç†","link":"#_3-2-æ•°æ®åº“äº‹åŠ¡ç®¡ç†","children":[]},{"level":3,"title":"3.3 è®¡æ—¶å™¨","slug":"_3-3-è®¡æ—¶å™¨","link":"#_3-3-è®¡æ—¶å™¨","children":[]}]},{"level":2,"title":"4. åµŒå¥—ä¸Šä¸‹æ–‡ç®¡ç†å™¨","slug":"_4-åµŒå¥—ä¸Šä¸‹æ–‡ç®¡ç†å™¨","link":"#_4-åµŒå¥—ä¸Šä¸‹æ–‡ç®¡ç†å™¨","children":[{"level":3,"title":"4.1 å¤šä¸ª with è¯­å¥","slug":"_4-1-å¤šä¸ª-with-è¯­å¥","link":"#_4-1-å¤šä¸ª-with-è¯­å¥","children":[]},{"level":3,"title":"4.2 ExitStack","slug":"_4-2-exitstack","link":"#_4-2-exitstack","children":[]}]},{"level":2,"title":"5. å®æˆ˜æ¡ˆä¾‹","slug":"_5-å®æˆ˜æ¡ˆä¾‹","link":"#_5-å®æˆ˜æ¡ˆä¾‹","children":[{"level":3,"title":"æ¡ˆä¾‹1ï¼šä¸´æ—¶ç›®å½•","slug":"æ¡ˆä¾‹1-ä¸´æ—¶ç›®å½•","link":"#æ¡ˆä¾‹1-ä¸´æ—¶ç›®å½•","children":[]},{"level":3,"title":"æ¡ˆä¾‹2ï¼šçŠ¶æ€åˆ‡æ¢","slug":"æ¡ˆä¾‹2-çŠ¶æ€åˆ‡æ¢","link":"#æ¡ˆä¾‹2-çŠ¶æ€åˆ‡æ¢","children":[]},{"level":3,"title":"æ¡ˆä¾‹3ï¼šèµ„æºé”","slug":"æ¡ˆä¾‹3-èµ„æºé”","link":"#æ¡ˆä¾‹3-èµ„æºé”","children":[]}]},{"level":2,"title":"6. å¼‚å¸¸å¤„ç†","slug":"_6-å¼‚å¸¸å¤„ç†","link":"#_6-å¼‚å¸¸å¤„ç†","children":[{"level":3,"title":"6.1 æŠ‘åˆ¶å¼‚å¸¸","slug":"_6-1-æŠ‘åˆ¶å¼‚å¸¸","link":"#_6-1-æŠ‘åˆ¶å¼‚å¸¸","children":[]},{"level":3,"title":"6.2 suppress ä¸Šä¸‹æ–‡ç®¡ç†å™¨","slug":"_6-2-suppress-ä¸Šä¸‹æ–‡ç®¡ç†å™¨","link":"#_6-2-suppress-ä¸Šä¸‹æ–‡ç®¡ç†å™¨","children":[]}]},{"level":2,"title":"7. æœ€ä½³å®è·µ","slug":"_7-æœ€ä½³å®è·µ","link":"#_7-æœ€ä½³å®è·µ","children":[]},{"level":2,"title":"ğŸ“ ç»ƒä¹ é¢˜","slug":"ğŸ“-ç»ƒä¹ é¢˜","link":"#ğŸ“-ç»ƒä¹ é¢˜","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/python/ç¬¬03ç« -è¿›é˜¶ç¼–ç¨‹/04-ä¸Šä¸‹æ–‡ç®¡ç†å™¨.md"}');export{m as comp,b as data};
