import{_ as l,c as i,d as p,e as s,f as a,b as t,w as c,r as o,o as u}from"./app-D9dfRPMK.js";const r={};function d(m,n){const e=o("RouteLink");return u(),i("div",null,[n[3]||(n[3]=p(`<h1 id="_05-rabbitmqé›†ç¾¤ä¸ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_05-rabbitmqé›†ç¾¤ä¸ç›‘æ§"><span>05 - RabbitMQé›†ç¾¤ä¸ç›‘æ§</span></a></h1><h2 id="ğŸ¯-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ¯-å­¦ä¹ ç›®æ ‡"><span>ğŸ¯ å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>ç†è§£RabbitMQé›†ç¾¤æ¶æ„</li><li>æŒæ¡é›†ç¾¤æ­å»ºæ–¹æ³•</li><li>å­¦ä¼šé…ç½®é•œåƒé˜Ÿåˆ—</li><li>äº†è§£æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</li><li>æŒæ¡ç›‘æ§å’Œå‘Šè­¦æ–¹æ¡ˆ</li></ul><h2 id="ğŸ—ï¸-é›†ç¾¤æ¶æ„" tabindex="-1"><a class="header-anchor" href="#ğŸ—ï¸-é›†ç¾¤æ¶æ„"><span>ğŸ—ï¸ é›†ç¾¤æ¶æ„</span></a></h2><h3 id="é›†ç¾¤æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#é›†ç¾¤æ¨¡å¼"><span>é›†ç¾¤æ¨¡å¼</span></a></h3><p>RabbitMQæœ‰ä¸‰ç§é›†ç¾¤æ¨¡å¼ï¼š</p><h4 id="_1-æ™®é€šé›†ç¾¤æ¨¡å¼-é»˜è®¤" tabindex="-1"><a class="header-anchor" href="#_1-æ™®é€šé›†ç¾¤æ¨¡å¼-é»˜è®¤"><span>1. æ™®é€šé›†ç¾¤æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰</span></a></h4><ul><li>é˜Ÿåˆ—æ•°æ®åªå­˜åœ¨äºä¸€ä¸ªèŠ‚ç‚¹</li><li>å…¶ä»–èŠ‚ç‚¹åªæœ‰å…ƒæ•°æ®</li><li>æ¶ˆè´¹æ—¶ä¼šä»å­˜å‚¨èŠ‚ç‚¹æ‹‰å–</li></ul><h4 id="_2-é•œåƒé˜Ÿåˆ—æ¨¡å¼-æ¨è" tabindex="-1"><a class="header-anchor" href="#_2-é•œåƒé˜Ÿåˆ—æ¨¡å¼-æ¨è"><span>2. é•œåƒé˜Ÿåˆ—æ¨¡å¼ï¼ˆæ¨èï¼‰</span></a></h4><ul><li>é˜Ÿåˆ—æ•°æ®åœ¨æ‰€æœ‰èŠ‚ç‚¹åŒæ­¥</li><li>é«˜å¯ç”¨ï¼Œä¸€ä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¸å½±å“</li><li>æ€§èƒ½æœ‰æ‰€ä¸‹é™</li></ul><h4 id="_3-ä»²è£é˜Ÿåˆ—æ¨¡å¼-quorum-queue" tabindex="-1"><a class="header-anchor" href="#_3-ä»²è£é˜Ÿåˆ—æ¨¡å¼-quorum-queue"><span>3. ä»²è£é˜Ÿåˆ—æ¨¡å¼ï¼ˆQuorum Queueï¼‰</span></a></h4><ul><li>RabbitMQ 3.8+æ–°ç‰¹æ€§</li><li>åŸºäºRaftåè®®</li><li>æ›´é«˜çš„æ•°æ®ä¸€è‡´æ€§</li></ul><h2 id="ğŸ”§-é›†ç¾¤æ­å»º" tabindex="-1"><a class="header-anchor" href="#ğŸ”§-é›†ç¾¤æ­å»º"><span>ğŸ”§ é›†ç¾¤æ­å»º</span></a></h2><h3 id="docker-composeæ­å»º" tabindex="-1"><a class="header-anchor" href="#docker-composeæ­å»º"><span>Docker Composeæ­å»º</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.8&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">services</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">rabbitmq1</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> rabbitmq<span class="token punctuation">:</span>3.12<span class="token punctuation">-</span>management</span>
<span class="line">    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> rabbitmq1</span>
<span class="line">    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rabbitmq1</span>
<span class="line">    <span class="token key atrule">environment</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> RABBITMQ_ERLANG_COOKIE=SECRETCOOKIE</span>
<span class="line">      <span class="token punctuation">-</span> RABBITMQ_DEFAULT_USER=admin</span>
<span class="line">      <span class="token punctuation">-</span> RABBITMQ_DEFAULT_PASS=admin123</span>
<span class="line">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;5672:5672&quot;</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;15672:15672&quot;</span></span>
<span class="line">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> ./rabbitmq1<span class="token punctuation">:</span>/var/lib/rabbitmq</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">rabbitmq2</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> rabbitmq<span class="token punctuation">:</span>3.12<span class="token punctuation">-</span>management</span>
<span class="line">    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> rabbitmq2</span>
<span class="line">    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rabbitmq2</span>
<span class="line">    <span class="token key atrule">environment</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> RABBITMQ_ERLANG_COOKIE=SECRETCOOKIE</span>
<span class="line">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;5673:5672&quot;</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;15673:15672&quot;</span></span>
<span class="line">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> ./rabbitmq2<span class="token punctuation">:</span>/var/lib/rabbitmq</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">rabbitmq3</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> rabbitmq<span class="token punctuation">:</span>3.12<span class="token punctuation">-</span>management</span>
<span class="line">    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> rabbitmq3</span>
<span class="line">    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rabbitmq3</span>
<span class="line">    <span class="token key atrule">environment</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> RABBITMQ_ERLANG_COOKIE=SECRETCOOKIE</span>
<span class="line">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;5674:5672&quot;</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;15674:15672&quot;</span></span>
<span class="line">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> ./rabbitmq3<span class="token punctuation">:</span>/var/lib/rabbitmq</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŠ å…¥é›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#åŠ å…¥é›†ç¾¤"><span>åŠ å…¥é›†ç¾¤</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># è¿›å…¥rabbitmq2å®¹å™¨</span></span>
<span class="line"><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq2 <span class="token function">bash</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åœæ­¢åº”ç”¨</span></span>
<span class="line">rabbitmqctl stop_app</span>
<span class="line"></span>
<span class="line"><span class="token comment"># é‡ç½®èŠ‚ç‚¹</span></span>
<span class="line">rabbitmqctl reset</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ å…¥é›†ç¾¤</span></span>
<span class="line">rabbitmqctl join_cluster rabbit@rabbitmq1</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯åŠ¨åº”ç”¨</span></span>
<span class="line">rabbitmqctl start_app</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŒæ ·æ“ä½œrabbitmq3</span></span>
<span class="line"><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq3 <span class="token function">bash</span></span>
<span class="line">rabbitmqctl stop_app</span>
<span class="line">rabbitmqctl reset</span>
<span class="line">rabbitmqctl join_cluster rabbit@rabbitmq1</span>
<span class="line">rabbitmqctl start_app</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</span></span>
<span class="line">rabbitmqctl cluster_status</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ”„-é•œåƒé˜Ÿåˆ—é…ç½®" tabindex="-1"><a class="header-anchor" href="#ğŸ”„-é•œåƒé˜Ÿåˆ—é…ç½®"><span>ğŸ”„ é•œåƒé˜Ÿåˆ—é…ç½®</span></a></h2><h3 id="é€šè¿‡å‘½ä»¤é…ç½®" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡å‘½ä»¤é…ç½®"><span>é€šè¿‡å‘½ä»¤é…ç½®</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># è®¾ç½®æ‰€æœ‰é˜Ÿåˆ—ä¸ºé•œåƒé˜Ÿåˆ—ï¼ˆ2ä¸ªå‰¯æœ¬ï¼‰</span></span>
<span class="line">rabbitmqctl set_policy ha-all <span class="token string">&quot;^&quot;</span> <span class="token string">&#39;{&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2,&quot;ha-sync-mode&quot;:&quot;automatic&quot;}&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¾ç½®ç‰¹å®šé˜Ÿåˆ—ä¸ºé•œåƒé˜Ÿåˆ—</span></span>
<span class="line">rabbitmqctl set_policy ha-order <span class="token string">&quot;^order\\.&quot;</span> <span class="token string">&#39;{&quot;ha-mode&quot;:&quot;all&quot;,&quot;ha-sync-mode&quot;:&quot;automatic&quot;}&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹ç­–ç•¥</span></span>
<span class="line">rabbitmqctl list_policies</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é€šè¿‡ç®¡ç†ç•Œé¢é…ç½®" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡ç®¡ç†ç•Œé¢é…ç½®"><span>é€šè¿‡ç®¡ç†ç•Œé¢é…ç½®</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">è®¿é—®: http://localhost:15672</span>
<span class="line">Admin â†’ Policies â†’ Add/Update Policy</span>
<span class="line"></span>
<span class="line">Name: ha-all</span>
<span class="line">Pattern: ^</span>
<span class="line">Apply to: queues</span>
<span class="line">Definition:</span>
<span class="line">  ha-mode: all</span>
<span class="line">  ha-sync-mode: automatic</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é•œåƒé˜Ÿåˆ—å‚æ•°" tabindex="-1"><a class="header-anchor" href="#é•œåƒé˜Ÿåˆ—å‚æ•°"><span>é•œåƒé˜Ÿåˆ—å‚æ•°</span></a></h3><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>å€¼</th></tr></thead><tbody><tr><td>ha-mode</td><td>é•œåƒæ¨¡å¼</td><td>allï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰<br>exactlyï¼ˆæŒ‡å®šæ•°é‡ï¼‰<br>nodesï¼ˆæŒ‡å®šèŠ‚ç‚¹ï¼‰</td></tr><tr><td>ha-params</td><td>å‚æ•°</td><td>èŠ‚ç‚¹æ•°é‡æˆ–èŠ‚ç‚¹åç§°åˆ—è¡¨</td></tr><tr><td>ha-sync-mode</td><td>åŒæ­¥æ¨¡å¼</td><td>automaticï¼ˆè‡ªåŠ¨ï¼‰<br>manualï¼ˆæ‰‹åŠ¨ï¼‰</td></tr></tbody></table><h2 id="ğŸš€-spring-bootè¿æ¥é›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#ğŸš€-spring-bootè¿æ¥é›†ç¾¤"><span>ğŸš€ Spring Bootè¿æ¥é›†ç¾¤</span></a></h2><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># é›†ç¾¤åœ°å€</span></span>
<span class="line">    <span class="token key atrule">addresses</span><span class="token punctuation">:</span> 192.168.1.101<span class="token punctuation">:</span><span class="token number">5672</span><span class="token punctuation">,</span>192.168.1.102<span class="token punctuation">:</span><span class="token number">5672</span><span class="token punctuation">,</span>192.168.1.103<span class="token punctuation">:</span><span class="token number">5672</span></span>
<span class="line">    <span class="token key atrule">username</span><span class="token punctuation">:</span> admin</span>
<span class="line">    <span class="token key atrule">password</span><span class="token punctuation">:</span> admin123</span>
<span class="line">    <span class="token key atrule">virtual-host</span><span class="token punctuation">:</span> /</span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è¿æ¥æ± é…ç½®</span></span>
<span class="line">    <span class="token key atrule">listener</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">simple</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">prefetch</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line">        <span class="token key atrule">concurrency</span><span class="token punctuation">:</span> <span class="token number">5</span></span>
<span class="line">        <span class="token key atrule">max-concurrency</span><span class="token punctuation">:</span> <span class="token number">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“Š-æ€§èƒ½ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ğŸ“Š-æ€§èƒ½ä¼˜åŒ–"><span>ğŸ“Š æ€§èƒ½ä¼˜åŒ–</span></a></h2><h3 id="_1-æ¶ˆæ¯æŒä¹…åŒ–ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_1-æ¶ˆæ¯æŒä¹…åŒ–ä¼˜åŒ–"><span>1. æ¶ˆæ¯æŒä¹…åŒ–ä¼˜åŒ–</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token comment">// æ‰¹é‡å‘é€ï¼Œå‡å°‘IO</span></span>
<span class="line"><span class="token annotation punctuation">@Service</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BatchSender</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line">    <span class="token annotation punctuation">@Autowired</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">batchSend</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> messages<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// å¼€å¯äº‹åŠ¡</span></span>
<span class="line">        rabbitTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>channel <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> message <span class="token operator">:</span> messages<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;queue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-é¢„å–æ•°é‡ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_2-é¢„å–æ•°é‡ä¼˜åŒ–"><span>2. é¢„å–æ•°é‡ä¼˜åŒ–</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">listener</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">simple</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># ä¸€æ¬¡æ‹‰å–æ¶ˆæ¯æ•°é‡</span></span>
<span class="line">        <span class="token key atrule">prefetch</span><span class="token punctuation">:</span> <span class="token number">50</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-è¿æ¥æ± ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_3-è¿æ¥æ± ä¼˜åŒ–"><span>3. è¿æ¥æ± ä¼˜åŒ–</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">cache</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">connection</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">mode</span><span class="token punctuation">:</span> channel</span>
<span class="line">        <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">25</span></span>
<span class="line">      <span class="token key atrule">channel</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">50</span></span>
<span class="line">        <span class="token key atrule">checkout-timeout</span><span class="token punctuation">:</span> <span class="token number">5000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-æ¶ˆè´¹è€…å¹¶å‘ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_4-æ¶ˆè´¹è€…å¹¶å‘ä¼˜åŒ–"><span>4. æ¶ˆè´¹è€…å¹¶å‘ä¼˜åŒ–</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span></span>
<span class="line">    queues <span class="token operator">=</span> <span class="token string">&quot;high-traffic.queue&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    concurrency <span class="token operator">=</span> <span class="token string">&quot;5-10&quot;</span>  <span class="token comment">// æœ€å°5ä¸ªï¼Œæœ€å¤š10ä¸ªæ¶ˆè´¹è€…</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// å¤„ç†æ¶ˆæ¯</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-æƒ°æ€§é˜Ÿåˆ—" tabindex="-1"><a class="header-anchor" href="#_5-æƒ°æ€§é˜Ÿåˆ—"><span>5. æƒ°æ€§é˜Ÿåˆ—</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token comment">// å¤§é‡æ¶ˆæ¯æ—¶ä½¿ç”¨æƒ°æ€§é˜Ÿåˆ—</span></span>
<span class="line"><span class="token annotation punctuation">@Bean</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">lazyQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">QueueBuilder</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">durable</span><span class="token punctuation">(</span><span class="token string">&quot;lazy.queue&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// å¯ç”¨æƒ°æ€§æ¨¡å¼</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“ˆ-ç›‘æ§æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#ğŸ“ˆ-ç›‘æ§æ–¹æ¡ˆ"><span>ğŸ“ˆ ç›‘æ§æ–¹æ¡ˆ</span></a></h2><h3 id="_1-ç®¡ç†ç•Œé¢ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_1-ç®¡ç†ç•Œé¢ç›‘æ§"><span>1. ç®¡ç†ç•Œé¢ç›‘æ§</span></a></h3><p>è®¿é—®: <code>http://localhost:15672</code></p><p><strong>å…³é”®æŒ‡æ ‡ï¼š</strong></p><ul><li>é˜Ÿåˆ—æ¶ˆæ¯æ•°é‡</li><li>æ¶ˆè´¹é€Ÿåº¦</li><li>å‘å¸ƒé€Ÿåº¦</li><li>å†…å­˜ä½¿ç”¨</li><li>è¿æ¥æ•°</li></ul><h3 id="_2-http-apiç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_2-http-apiç›‘æ§"><span>2. HTTP APIç›‘æ§</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Service</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQMonitor</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> apiUrl <span class="token operator">=</span> <span class="token string">&quot;http://localhost:15672/api&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> auth <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span><span class="token string">&quot;admin:admin123&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">QueueInfo</span> <span class="token function">getQueueInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> queueName<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">HttpHeaders</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        headers<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Basic &quot;</span> <span class="token operator">+</span> auth<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> entity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QueueInfo</span><span class="token punctuation">&gt;</span></span> response <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span></span>
<span class="line">            apiUrl <span class="token operator">+</span> <span class="token string">&quot;/queues/%2F/&quot;</span> <span class="token operator">+</span> queueName<span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token constant">GET</span><span class="token punctuation">,</span></span>
<span class="line">            entity<span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">QueueInfo</span><span class="token punctuation">.</span><span class="token keyword">class</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-prometheus-grafanaç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_3-prometheus-grafanaç›‘æ§"><span>3. Prometheus + Grafanaç›‘æ§</span></a></h3><p><strong>å¯ç”¨Prometheusæ’ä»¶ï¼š</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">rabbitmq-plugins <span class="token builtin class-name">enable</span> rabbitmq_prometheus</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>Prometheusé…ç½®ï¼š</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">&#39;rabbitmq&#39;</span></span>
<span class="line">    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;localhost:15692&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Grafana Dashboard ID:</strong> 10991</p><h3 id="_4-å‘Šè­¦è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_4-å‘Šè­¦è§„åˆ™"><span>4. å‘Šè­¦è§„åˆ™</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token comment"># Prometheuså‘Šè­¦è§„åˆ™</span></span>
<span class="line"><span class="token key atrule">groups</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> rabbitmq</span>
<span class="line">    <span class="token key atrule">rules</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token comment"># é˜Ÿåˆ—æ¶ˆæ¯ç§¯å‹å‘Šè­¦</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">alert</span><span class="token punctuation">:</span> RabbitMQQueueBacklog</span>
<span class="line">        <span class="token key atrule">expr</span><span class="token punctuation">:</span> rabbitmq_queue_messages <span class="token punctuation">&gt;</span> 10000</span>
<span class="line">        <span class="token key atrule">for</span><span class="token punctuation">:</span> 5m</span>
<span class="line">        <span class="token key atrule">annotations</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">summary</span><span class="token punctuation">:</span> <span class="token string">&quot;é˜Ÿåˆ—æ¶ˆæ¯ç§¯å‹&quot;</span></span>
<span class="line">          <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;é˜Ÿåˆ—{{ $labels.queue }}æ¶ˆæ¯æ•°: {{ $value }}&quot;</span></span>
<span class="line">      </span>
<span class="line">      <span class="token comment"># æ¶ˆè´¹é€Ÿåº¦è¿‡æ…¢</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">alert</span><span class="token punctuation">:</span> RabbitMQSlowConsume</span>
<span class="line">        <span class="token key atrule">expr</span><span class="token punctuation">:</span> rate(rabbitmq_queue_messages_consumed_total<span class="token punctuation">[</span>5m<span class="token punctuation">]</span>) &lt; 10</span>
<span class="line">        <span class="token key atrule">for</span><span class="token punctuation">:</span> 5m</span>
<span class="line">        <span class="token key atrule">annotations</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">summary</span><span class="token punctuation">:</span> <span class="token string">&quot;æ¶ˆè´¹é€Ÿåº¦è¿‡æ…¢&quot;</span></span>
<span class="line">      </span>
<span class="line">      <span class="token comment"># èŠ‚ç‚¹å†…å­˜å‘Šè­¦</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">alert</span><span class="token punctuation">:</span> RabbitMQHighMemory</span>
<span class="line">        <span class="token key atrule">expr</span><span class="token punctuation">:</span> rabbitmq_node_mem_used / rabbitmq_node_mem_limit <span class="token punctuation">&gt;</span> 0.8</span>
<span class="line">        <span class="token key atrule">for</span><span class="token punctuation">:</span> 5m</span>
<span class="line">        <span class="token key atrule">annotations</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">summary</span><span class="token punctuation">:</span> <span class="token string">&quot;å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ”-å¸¸ç”¨è¿ç»´å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#ğŸ”-å¸¸ç”¨è¿ç»´å‘½ä»¤"><span>ğŸ” å¸¸ç”¨è¿ç»´å‘½ä»¤</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</span></span>
<span class="line">rabbitmqctl cluster_status</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹é˜Ÿåˆ—</span></span>
<span class="line">rabbitmqctl list_queues name messages consumers</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹äº¤æ¢æœº</span></span>
<span class="line">rabbitmqctl list_exchanges</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹ç»‘å®š</span></span>
<span class="line">rabbitmqctl list_bindings</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹è¿æ¥</span></span>
<span class="line">rabbitmqctl list_connections</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹é€šé“</span></span>
<span class="line">rabbitmqctl list_channels</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¸…ç©ºé˜Ÿåˆ—</span></span>
<span class="line">rabbitmqctl purge_queue queue_name</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ é™¤é˜Ÿåˆ—</span></span>
<span class="line">rabbitmqctl delete_queue queue_name</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹å†…å­˜ä½¿ç”¨</span></span>
<span class="line">rabbitmqctl status <span class="token operator">|</span> <span class="token function">grep</span> memory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># é‡ç½®èŠ‚ç‚¹</span></span>
<span class="line">rabbitmqctl reset</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="âš™ï¸-è°ƒä¼˜å»ºè®®" tabindex="-1"><a class="header-anchor" href="#âš™ï¸-è°ƒä¼˜å»ºè®®"><span>âš™ï¸ è°ƒä¼˜å»ºè®®</span></a></h2><h3 id="_1-ç³»ç»Ÿå±‚é¢" tabindex="-1"><a class="header-anchor" href="#_1-ç³»ç»Ÿå±‚é¢"><span>1. ç³»ç»Ÿå±‚é¢</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># å¢åŠ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶</span></span>
<span class="line"><span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-n</span> <span class="token number">65536</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¿®æ”¹/etc/security/limits.conf</span></span>
<span class="line">* soft nofile <span class="token number">65536</span></span>
<span class="line">* hard nofile <span class="token number">65536</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-rabbitmqé…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-rabbitmqé…ç½®"><span>2. RabbitMQé…ç½®</span></a></h3><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line"># rabbitmq.conf</span>
<span class="line"></span>
<span class="line"># VMå†…å­˜é«˜æ°´ä½ï¼ˆ40%ï¼‰</span>
<span class="line">vm_memory_high_watermark.relative = 0.4</span>
<span class="line"></span>
<span class="line"># ç£ç›˜ç©ºé—²ç©ºé—´é˜ˆå€¼ï¼ˆ50GBï¼‰</span>
<span class="line">disk_free_limit.absolute = 50GB</span>
<span class="line"></span>
<span class="line"># å¿ƒè·³è¶…æ—¶</span>
<span class="line">heartbeat = 60</span>
<span class="line"></span>
<span class="line"># é€šé“æœ€å¤§æ•°é‡</span>
<span class="line">channel_max = 2048</span>
<span class="line"></span>
<span class="line"># æœ€å¤§è¿æ¥æ•°</span>
<span class="line">num_acceptors.tcp = 10</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-é˜Ÿåˆ—ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_3-é˜Ÿåˆ—ä¼˜åŒ–"><span>3. é˜Ÿåˆ—ä¼˜åŒ–</span></a></h3><ul><li>ä½¿ç”¨æƒ°æ€§é˜Ÿåˆ—å¤„ç†å¤§é‡æ¶ˆæ¯</li><li>è®¾ç½®åˆç†çš„TTL</li><li>ä½¿ç”¨æ­»ä¿¡é˜Ÿåˆ—å¤„ç†å¼‚å¸¸</li><li>é™åˆ¶é˜Ÿåˆ—é•¿åº¦</li><li>åˆç†è®¾ç½®prefetch</li></ul><h2 id="ğŸ’¡-é«˜å¯ç”¨æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#ğŸ’¡-é«˜å¯ç”¨æ–¹æ¡ˆ"><span>ğŸ’¡ é«˜å¯ç”¨æ–¹æ¡ˆ</span></a></h2><h3 id="_1-é›†ç¾¤-é•œåƒé˜Ÿåˆ—" tabindex="-1"><a class="header-anchor" href="#_1-é›†ç¾¤-é•œåƒé˜Ÿåˆ—"><span>1. é›†ç¾¤ + é•œåƒé˜Ÿåˆ—</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Node1(Master) â† â†’ Node2(Slave) â† â†’ Node3(Slave)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-haproxyè´Ÿè½½å‡è¡¡" tabindex="-1"><a class="header-anchor" href="#_2-haproxyè´Ÿè½½å‡è¡¡"><span>2. HAProxyè´Ÿè½½å‡è¡¡</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">HAProxy</span>
<span class="line">  â†“</span>
<span class="line">â”œâ”€ RabbitMQ1</span>
<span class="line">â”œâ”€ RabbitMQ2</span>
<span class="line">â””â”€ RabbitMQ3</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>HAProxyé…ç½®ï¼š</strong></p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">listen rabbitmq_cluster</span>
<span class="line">    bind 0.0.0.0:5670</span>
<span class="line">    mode tcp</span>
<span class="line">    balance roundrobin</span>
<span class="line">    server rabbit1 192.168.1.101:5672 check</span>
<span class="line">    server rabbit2 192.168.1.102:5672 check</span>
<span class="line">    server rabbit3 192.168.1.103:5672 check</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ¯-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ¯-å°ç»“"><span>ğŸ¯ å°ç»“</span></a></h2><p>æœ¬èŠ‚å­¦ä¹ äº†RabbitMQé›†ç¾¤ä¸ç›‘æ§ï¼š</p><ul><li>âœ… é›†ç¾¤æ¶æ„å’Œæ­å»º</li><li>âœ… é•œåƒé˜Ÿåˆ—é…ç½®</li><li>âœ… æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</li><li>âœ… ç›‘æ§å‘Šè­¦æ–¹æ¡ˆ</li><li>âœ… é«˜å¯ç”¨éƒ¨ç½²</li></ul><hr>`,72)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),t(e,{to:"/tutorials/java-backend/rabbitmq/06-RabbitMQ%E9%9D%A2%E8%AF%95%E9%A2%98.html"},{default:c(()=>[...n[0]||(n[0]=[a("06-RabbitMQé¢è¯•é¢˜",-1)])]),_:1})])])}const b=l(r,[["render",d]]),k=JSON.parse('{"path":"/tutorials/java-backend/rabbitmq/05-RabbitMQjiqunyujiankong.html","title":"RabbitMQé›†ç¾¤ä¸ç›‘æ§","lang":"zh-CN","frontmatter":{"title":"RabbitMQé›†ç¾¤ä¸ç›‘æ§"},"headers":[{"level":2,"title":"ğŸ¯ å­¦ä¹ ç›®æ ‡","slug":"ğŸ¯-å­¦ä¹ ç›®æ ‡","link":"#ğŸ¯-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"ğŸ—ï¸ é›†ç¾¤æ¶æ„","slug":"ğŸ—ï¸-é›†ç¾¤æ¶æ„","link":"#ğŸ—ï¸-é›†ç¾¤æ¶æ„","children":[{"level":3,"title":"é›†ç¾¤æ¨¡å¼","slug":"é›†ç¾¤æ¨¡å¼","link":"#é›†ç¾¤æ¨¡å¼","children":[]}]},{"level":2,"title":"ğŸ”§ é›†ç¾¤æ­å»º","slug":"ğŸ”§-é›†ç¾¤æ­å»º","link":"#ğŸ”§-é›†ç¾¤æ­å»º","children":[{"level":3,"title":"Docker Composeæ­å»º","slug":"docker-composeæ­å»º","link":"#docker-composeæ­å»º","children":[]},{"level":3,"title":"åŠ å…¥é›†ç¾¤","slug":"åŠ å…¥é›†ç¾¤","link":"#åŠ å…¥é›†ç¾¤","children":[]}]},{"level":2,"title":"ğŸ”„ é•œåƒé˜Ÿåˆ—é…ç½®","slug":"ğŸ”„-é•œåƒé˜Ÿåˆ—é…ç½®","link":"#ğŸ”„-é•œåƒé˜Ÿåˆ—é…ç½®","children":[{"level":3,"title":"é€šè¿‡å‘½ä»¤é…ç½®","slug":"é€šè¿‡å‘½ä»¤é…ç½®","link":"#é€šè¿‡å‘½ä»¤é…ç½®","children":[]},{"level":3,"title":"é€šè¿‡ç®¡ç†ç•Œé¢é…ç½®","slug":"é€šè¿‡ç®¡ç†ç•Œé¢é…ç½®","link":"#é€šè¿‡ç®¡ç†ç•Œé¢é…ç½®","children":[]},{"level":3,"title":"é•œåƒé˜Ÿåˆ—å‚æ•°","slug":"é•œåƒé˜Ÿåˆ—å‚æ•°","link":"#é•œåƒé˜Ÿåˆ—å‚æ•°","children":[]}]},{"level":2,"title":"ğŸš€ Spring Bootè¿æ¥é›†ç¾¤","slug":"ğŸš€-spring-bootè¿æ¥é›†ç¾¤","link":"#ğŸš€-spring-bootè¿æ¥é›†ç¾¤","children":[]},{"level":2,"title":"ğŸ“Š æ€§èƒ½ä¼˜åŒ–","slug":"ğŸ“Š-æ€§èƒ½ä¼˜åŒ–","link":"#ğŸ“Š-æ€§èƒ½ä¼˜åŒ–","children":[{"level":3,"title":"1. æ¶ˆæ¯æŒä¹…åŒ–ä¼˜åŒ–","slug":"_1-æ¶ˆæ¯æŒä¹…åŒ–ä¼˜åŒ–","link":"#_1-æ¶ˆæ¯æŒä¹…åŒ–ä¼˜åŒ–","children":[]},{"level":3,"title":"2. é¢„å–æ•°é‡ä¼˜åŒ–","slug":"_2-é¢„å–æ•°é‡ä¼˜åŒ–","link":"#_2-é¢„å–æ•°é‡ä¼˜åŒ–","children":[]},{"level":3,"title":"3. è¿æ¥æ± ä¼˜åŒ–","slug":"_3-è¿æ¥æ± ä¼˜åŒ–","link":"#_3-è¿æ¥æ± ä¼˜åŒ–","children":[]},{"level":3,"title":"4. æ¶ˆè´¹è€…å¹¶å‘ä¼˜åŒ–","slug":"_4-æ¶ˆè´¹è€…å¹¶å‘ä¼˜åŒ–","link":"#_4-æ¶ˆè´¹è€…å¹¶å‘ä¼˜åŒ–","children":[]},{"level":3,"title":"5. æƒ°æ€§é˜Ÿåˆ—","slug":"_5-æƒ°æ€§é˜Ÿåˆ—","link":"#_5-æƒ°æ€§é˜Ÿåˆ—","children":[]}]},{"level":2,"title":"ğŸ“ˆ ç›‘æ§æ–¹æ¡ˆ","slug":"ğŸ“ˆ-ç›‘æ§æ–¹æ¡ˆ","link":"#ğŸ“ˆ-ç›‘æ§æ–¹æ¡ˆ","children":[{"level":3,"title":"1. ç®¡ç†ç•Œé¢ç›‘æ§","slug":"_1-ç®¡ç†ç•Œé¢ç›‘æ§","link":"#_1-ç®¡ç†ç•Œé¢ç›‘æ§","children":[]},{"level":3,"title":"2. HTTP APIç›‘æ§","slug":"_2-http-apiç›‘æ§","link":"#_2-http-apiç›‘æ§","children":[]},{"level":3,"title":"3. Prometheus + Grafanaç›‘æ§","slug":"_3-prometheus-grafanaç›‘æ§","link":"#_3-prometheus-grafanaç›‘æ§","children":[]},{"level":3,"title":"4. å‘Šè­¦è§„åˆ™","slug":"_4-å‘Šè­¦è§„åˆ™","link":"#_4-å‘Šè­¦è§„åˆ™","children":[]}]},{"level":2,"title":"ğŸ” å¸¸ç”¨è¿ç»´å‘½ä»¤","slug":"ğŸ”-å¸¸ç”¨è¿ç»´å‘½ä»¤","link":"#ğŸ”-å¸¸ç”¨è¿ç»´å‘½ä»¤","children":[]},{"level":2,"title":"âš™ï¸ è°ƒä¼˜å»ºè®®","slug":"âš™ï¸-è°ƒä¼˜å»ºè®®","link":"#âš™ï¸-è°ƒä¼˜å»ºè®®","children":[{"level":3,"title":"1. ç³»ç»Ÿå±‚é¢","slug":"_1-ç³»ç»Ÿå±‚é¢","link":"#_1-ç³»ç»Ÿå±‚é¢","children":[]},{"level":3,"title":"2. RabbitMQé…ç½®","slug":"_2-rabbitmqé…ç½®","link":"#_2-rabbitmqé…ç½®","children":[]},{"level":3,"title":"3. é˜Ÿåˆ—ä¼˜åŒ–","slug":"_3-é˜Ÿåˆ—ä¼˜åŒ–","link":"#_3-é˜Ÿåˆ—ä¼˜åŒ–","children":[]}]},{"level":2,"title":"ğŸ’¡ é«˜å¯ç”¨æ–¹æ¡ˆ","slug":"ğŸ’¡-é«˜å¯ç”¨æ–¹æ¡ˆ","link":"#ğŸ’¡-é«˜å¯ç”¨æ–¹æ¡ˆ","children":[{"level":3,"title":"1. é›†ç¾¤ + é•œåƒé˜Ÿåˆ—","slug":"_1-é›†ç¾¤-é•œåƒé˜Ÿåˆ—","link":"#_1-é›†ç¾¤-é•œåƒé˜Ÿåˆ—","children":[]},{"level":3,"title":"2. HAProxyè´Ÿè½½å‡è¡¡","slug":"_2-haproxyè´Ÿè½½å‡è¡¡","link":"#_2-haproxyè´Ÿè½½å‡è¡¡","children":[]}]},{"level":2,"title":"ğŸ¯ å°ç»“","slug":"ğŸ¯-å°ç»“","link":"#ğŸ¯-å°ç»“","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/java-backend/rabbitmq/05-RabbitMQé›†ç¾¤ä¸ç›‘æ§.md"}');export{b as comp,k as data};
