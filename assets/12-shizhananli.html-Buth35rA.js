import{_ as e,c,d as o,e as l,f as s,b as p,w as t,r as i,o as u}from"./app-D9dfRPMK.js";const k={};function r(d,n){const a=i("RouteLink");return u(),c("div",null,[n[4]||(n[4]=o(`<h1 id="å®æˆ˜æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#å®æˆ˜æ¡ˆä¾‹"><span>å®æˆ˜æ¡ˆä¾‹</span></a></h1><blockquote><p>é€šè¿‡å®æˆ˜é¡¹ç›®æŒæ¡Pandas</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>åº”ç”¨Pandasè§£å†³å®é™…é—®é¢˜</li><li>æŒæ¡å®Œæ•´æ•°æ®åˆ†ææµç¨‹</li><li>å­¦ä¼šç»¼åˆè¿ç”¨æ‰€å­¦çŸ¥è¯†</li></ul><h2 id="_1-é”€å”®æ•°æ®åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_1-é”€å”®æ•°æ®åˆ†æ"><span>1. é”€å”®æ•°æ®åˆ†æ</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">sales <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;sales.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ•°æ®æ¸…æ´—</span></span>
<span class="line">sales<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>sales<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">sales <span class="token operator">=</span> sales<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">sales <span class="token operator">=</span> sales<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ•°æ®åˆ†æ</span></span>
<span class="line">monthly_sales <span class="token operator">=</span> sales<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>sales<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>to_period<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;amount&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;quantity&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—å¢é•¿ç‡</span></span>
<span class="line">monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;growth&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–</span></span>
<span class="line">monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Monthly Sales Trend&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-ç”¨æˆ·è¡Œä¸ºåˆ†æ" tabindex="-1"><a class="header-anchor" href="#_2-ç”¨æˆ·è¡Œä¸ºåˆ†æ"><span>2. ç”¨æˆ·è¡Œä¸ºåˆ†æ</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># åŠ è½½ç”¨æˆ·è¡Œä¸ºæ•°æ®</span></span>
<span class="line">users <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;user_behavior.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ´»è·ƒç”¨æˆ·åˆ†æ</span></span>
<span class="line">daily_active <span class="token operator">=</span> users<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç•™å­˜ç‡è®¡ç®—</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">calculate_retention</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> days<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    first_day <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> first_day <span class="token operator">+</span> pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>days<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">retention_7d <span class="token operator">=</span> calculate_retention<span class="token punctuation">(</span>users<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-è‚¡ç¥¨æ•°æ®åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_3-è‚¡ç¥¨æ•°æ®åˆ†æ"><span>3. è‚¡ç¥¨æ•°æ®åˆ†æ</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># åŠ è½½è‚¡ç¥¨æ•°æ®</span></span>
<span class="line">stocks <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;stocks.csv&#39;</span><span class="token punctuation">,</span> parse_dates<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">stocks <span class="token operator">=</span> stocks<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—æ”¶ç›Šç‡</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;return&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç§»åŠ¨å¹³å‡</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;MA20&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;MA60&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ³¢åŠ¨ç‡</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token string">&#39;volatility&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> stocks<span class="token punctuation">[</span><span class="token string">&#39;return&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">252</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–</span></span>
<span class="line">stocks<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;MA20&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;MA60&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-æ–‡æœ¬æ•°æ®å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_4-æ–‡æœ¬æ•°æ®å¤„ç†"><span>4. æ–‡æœ¬æ•°æ®å¤„ç†</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># åŠ è½½è¯„è®ºæ•°æ®</span></span>
<span class="line">reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;reviews.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ–‡æœ¬æ¸…æ´—</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39;[^a-zA-Z]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æå–å…³é”®è¯</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;word_count&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æƒ…æ„Ÿåˆ†ç±»</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">classify_sentiment</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    positive_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;good&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;great&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;excellent&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    negative_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;bad&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;poor&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;terrible&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>word <span class="token keyword">in</span> text<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> word <span class="token keyword">in</span> positive_words<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;positive&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token builtin">any</span><span class="token punctuation">(</span>word <span class="token keyword">in</span> text<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> word <span class="token keyword">in</span> negative_words<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;negative&#39;</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;neutral&#39;</span></span>
<span class="line"></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>classify_sentiment<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç»Ÿè®¡åˆ†æ</span></span>
<span class="line">sentiment_counts <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-ç»¼åˆé¡¹ç›®-ç”µå•†æ•°æ®åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_5-ç»¼åˆé¡¹ç›®-ç”µå•†æ•°æ®åˆ†æ"><span>5. ç»¼åˆé¡¹ç›®ï¼šç”µå•†æ•°æ®åˆ†æ</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 1. æ•°æ®åŠ è½½</span></span>
<span class="line">orders <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;orders.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line">customers <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;customers.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line">products <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;products.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. æ•°æ®æ¸…æ´—</span></span>
<span class="line">orders<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>orders<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">orders <span class="token operator">=</span> orders<span class="token punctuation">[</span>orders<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. æ•°æ®åˆå¹¶</span></span>
<span class="line">data <span class="token operator">=</span> orders<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>customers<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">)</span></span>
<span class="line">data <span class="token operator">=</span> data<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>products<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;product_id&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. ç‰¹å¾å·¥ç¨‹</span></span>
<span class="line">data<span class="token punctuation">[</span><span class="token string">&#39;year_month&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>to_period<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span></span>
<span class="line">data<span class="token punctuation">[</span><span class="token string">&#39;day_of_week&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>dayofweek</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 5. åˆ†ææŒ‡æ ‡</span></span>
<span class="line"><span class="token comment"># é”€å”®è¶‹åŠ¿</span></span>
<span class="line">sales_trend <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;year_month&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®¢æˆ·ä»·å€¼åˆ†æ</span></span>
<span class="line">customer_value <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;order_id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;count&#39;</span><span class="token punctuation">,</span>      <span class="token comment"># è®¢å•æ•°</span></span>
<span class="line">    <span class="token string">&#39;amount&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span><span class="token punctuation">,</span>          <span class="token comment"># æ€»é‡‘é¢</span></span>
<span class="line">    <span class="token string">&#39;order_date&#39;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>days  <span class="token comment"># æ´»è·ƒå¤©æ•°</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">customer_value<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;order_count&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;total_amount&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;active_days&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># RFMåˆ†æ</span></span>
<span class="line">latest_date <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">rfm <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;order_date&#39;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>latest_date <span class="token operator">-</span> x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>days<span class="token punctuation">,</span>  <span class="token comment"># Recency</span></span>
<span class="line">    <span class="token string">&#39;order_id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;count&#39;</span><span class="token punctuation">,</span>                                    <span class="token comment"># Frequency</span></span>
<span class="line">    <span class="token string">&#39;amount&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span>                                         <span class="token comment"># Monetary</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;recency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;frequency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;monetary&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®¢æˆ·åˆ†å±‚</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;r_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>qcut<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;recency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;f_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>qcut<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;frequency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rank<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">&#39;first&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;m_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>qcut<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;monetary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;rfm_score&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> rfm<span class="token punctuation">[</span><span class="token string">&#39;r_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">+</span> rfm<span class="token punctuation">[</span><span class="token string">&#39;f_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">+</span> rfm<span class="token punctuation">[</span><span class="token string">&#39;m_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 6. å¯è§†åŒ–</span></span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"></span>
<span class="line">fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é”€å”®è¶‹åŠ¿</span></span>
<span class="line">sales_trend<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Sales Trend&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># äº§å“ç±»åˆ«åˆ†å¸ƒ</span></span>
<span class="line">data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;pie&#39;</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Sales by Category&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®¢æˆ·ä»·å€¼åˆ†å¸ƒ</span></span>
<span class="line">customer_value<span class="token punctuation">[</span><span class="token string">&#39;total_amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>hist<span class="token punctuation">(</span>bins<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;Customer Value Distribution&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># RFMå¾—åˆ†åˆ†å¸ƒ</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;rfm_score&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&#39;Top 10 RFM Segments&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&#39;ecommerce_analysis.png&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 7. ç”ŸæˆæŠ¥è¡¨</span></span>
<span class="line">report <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;æ€»é”€å”®é¢&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;æ€»è®¢å•æ•°&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">&#39;order_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;å®¢æˆ·æ€»æ•°&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">&#39;customer_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;å¹³å‡å®¢å•ä»·&#39;</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;order_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;amount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;å¤è´­ç‡&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>customer_value<span class="token punctuation">[</span><span class="token string">&#39;order_count&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>customer_value<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\\n=== æ•°æ®åˆ†ææŠ¥è¡¨ ===&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> report<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token format-spec">,.2f</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ’¡-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ’¡-æ€»ç»“"><span>ğŸ’¡ æ€»ç»“</span></a></h2><p>é€šè¿‡è¿™äº›å®æˆ˜æ¡ˆä¾‹ï¼Œä½ åº”è¯¥æŒæ¡äº†ï¼š</p><ol><li><strong>å®Œæ•´çš„æ•°æ®åˆ†ææµç¨‹</strong> - ä»æ•°æ®åŠ è½½åˆ°ç»“æœè¾“å‡º</li><li><strong>æ•°æ®æ¸…æ´—æŠ€å·§</strong> - å¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€é‡å¤æ•°æ®</li><li><strong>ç‰¹å¾å·¥ç¨‹</strong> - æå–å’Œæ„é€ æœ‰ç”¨çš„ç‰¹å¾</li><li><strong>æ•°æ®åˆ†ææ–¹æ³•</strong> - åˆ†ç»„ã€èšåˆã€é€è§†ç­‰</li><li><strong>å¯è§†åŒ–æŠ€å·§</strong> - ä½¿ç”¨å›¾è¡¨å±•ç¤ºåˆ†æç»“æœ</li><li><strong>ä¸šåŠ¡æ´å¯Ÿ</strong> - ä»æ•°æ®ä¸­å‘ç°ä¸šåŠ¡ä»·å€¼</li></ol><h2 id="ç»ƒä¹ é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#ç»ƒä¹ é¡¹ç›®"><span>ç»ƒä¹ é¡¹ç›®</span></a></h2><ol><li>åˆ†æTitanicæ•°æ®é›†ï¼Œé¢„æµ‹ç”Ÿå­˜ç‡</li><li>åˆ†ææˆ¿ä»·æ•°æ®ï¼Œæ‰¾å‡ºå½±å“å› ç´ </li><li>åˆ†æç”µå½±è¯„åˆ†æ•°æ®ï¼Œæ¨èç³»ç»Ÿ</li><li>åˆ†æå¤©æ°”æ•°æ®ï¼Œé¢„æµ‹è¶‹åŠ¿</li></ol><hr><p><strong>æ­å–œå®Œæˆ Pandas æ•™ç¨‹ï¼</strong> ğŸ‰</p>`,21)),l("p",null,[n[2]||(n[2]=s("ç»§ç»­å­¦ä¹ ï¼š",-1)),p(a,{to:"/tutorials/python-ai/matplotlib/"},{default:t(()=>[...n[0]||(n[0]=[s("Matplotlib æ•°æ®å¯è§†åŒ–",-1)])]),_:1}),n[3]||(n[3]=s(" æˆ– ",-1)),p(a,{to:"/tutorials/python-ai/ml-basics/"},{default:t(()=>[...n[1]||(n[1]=[s("æœºå™¨å­¦ä¹ åŸºç¡€",-1)])]),_:1})])])}const v=e(k,[["render",r]]),b=JSON.parse('{"path":"/tutorials/python-ai/pandas/12-shizhananli.html","title":"å®æˆ˜æ¡ˆä¾‹","lang":"zh-CN","frontmatter":{"title":"å®æˆ˜æ¡ˆä¾‹"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. é”€å”®æ•°æ®åˆ†æ","slug":"_1-é”€å”®æ•°æ®åˆ†æ","link":"#_1-é”€å”®æ•°æ®åˆ†æ","children":[]},{"level":2,"title":"2. ç”¨æˆ·è¡Œä¸ºåˆ†æ","slug":"_2-ç”¨æˆ·è¡Œä¸ºåˆ†æ","link":"#_2-ç”¨æˆ·è¡Œä¸ºåˆ†æ","children":[]},{"level":2,"title":"3. è‚¡ç¥¨æ•°æ®åˆ†æ","slug":"_3-è‚¡ç¥¨æ•°æ®åˆ†æ","link":"#_3-è‚¡ç¥¨æ•°æ®åˆ†æ","children":[]},{"level":2,"title":"4. æ–‡æœ¬æ•°æ®å¤„ç†","slug":"_4-æ–‡æœ¬æ•°æ®å¤„ç†","link":"#_4-æ–‡æœ¬æ•°æ®å¤„ç†","children":[]},{"level":2,"title":"5. ç»¼åˆé¡¹ç›®ï¼šç”µå•†æ•°æ®åˆ†æ","slug":"_5-ç»¼åˆé¡¹ç›®-ç”µå•†æ•°æ®åˆ†æ","link":"#_5-ç»¼åˆé¡¹ç›®-ç”µå•†æ•°æ®åˆ†æ","children":[]},{"level":2,"title":"ğŸ’¡ æ€»ç»“","slug":"ğŸ’¡-æ€»ç»“","link":"#ğŸ’¡-æ€»ç»“","children":[]},{"level":2,"title":"ç»ƒä¹ é¡¹ç›®","slug":"ç»ƒä¹ é¡¹ç›®","link":"#ç»ƒä¹ é¡¹ç›®","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/pandas/12-å®æˆ˜æ¡ˆä¾‹.md"}');export{v as comp,b as data};
