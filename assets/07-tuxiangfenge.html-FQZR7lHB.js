import{_ as t,c as e,d as c,e as s,f as a,b as l,w as o,r as i,o as u}from"./app-DyGs7pMe.js";const r={};function k(d,n){const p=i("RouteLink");return u(),e("div",null,[n[3]||(n[3]=c(`<h1 id="å›¾åƒåˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#å›¾åƒåˆ†å‰²"><span>å›¾åƒåˆ†å‰²</span></a></h1><blockquote><p>æŒæ¡å›¾åƒåˆ†å‰²æŠ€æœ¯</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>ç†è§£å›¾åƒåˆ†å‰²</li><li>æŒæ¡é˜ˆå€¼åˆ†å‰²</li><li>å­¦ä¼šGrabCutç®—æ³•</li><li>äº†è§£åˆ†æ°´å²­ç®—æ³•</li></ul><h2 id="_1-é˜ˆå€¼åˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#_1-é˜ˆå€¼åˆ†å‰²"><span>1. é˜ˆå€¼åˆ†å‰²</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"></span>
<span class="line">gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å…¨å±€é˜ˆå€¼</span></span>
<span class="line">ret<span class="token punctuation">,</span> binary <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è‡ªé€‚åº”é˜ˆå€¼</span></span>
<span class="line">adaptive <span class="token operator">=</span> cv2<span class="token punctuation">.</span>adaptiveThreshold<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> </span>
<span class="line">                                 cv2<span class="token punctuation">.</span>ADAPTIVE_THRESH_GAUSSIAN_C<span class="token punctuation">,</span></span>
<span class="line">                                 cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Otsué˜ˆå€¼</span></span>
<span class="line">ret<span class="token punctuation">,</span> otsu <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> </span>
<span class="line">                          cv2<span class="token punctuation">.</span>THRESH_BINARY <span class="token operator">+</span> cv2<span class="token punctuation">.</span>THRESH_OTSU<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-grabcut" tabindex="-1"><a class="header-anchor" href="#_2-grabcut"><span>2. GrabCut</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®šä¹‰å‰æ™¯åŒºåŸŸ</span></span>
<span class="line">rect <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">,</span> <span class="token number">290</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆå§‹åŒ–mask</span></span>
<span class="line">mask <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span></span>
<span class="line">bgdModel <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>float64<span class="token punctuation">)</span></span>
<span class="line">fgdModel <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>float64<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰§è¡ŒGrabCut</span></span>
<span class="line">cv2<span class="token punctuation">.</span>grabCut<span class="token punctuation">(</span>img<span class="token punctuation">,</span> mask<span class="token punctuation">,</span> rect<span class="token punctuation">,</span> bgdModel<span class="token punctuation">,</span> fgdModel<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>GC_INIT_WITH_RECT<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æå–å‰æ™¯</span></span>
<span class="line">mask2 <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token punctuation">(</span>mask <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>mask <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;uint8&#39;</span><span class="token punctuation">)</span></span>
<span class="line">result <span class="token operator">=</span> img <span class="token operator">*</span> mask2<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-åˆ†æ°´å²­ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_3-åˆ†æ°´å²­ç®—æ³•"><span>3. åˆ†æ°´å²­ç®—æ³•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># è½¬ç°åº¦</span></span>
<span class="line">gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é˜ˆå€¼å¤„ç†</span></span>
<span class="line">ret<span class="token punctuation">,</span> thresh <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> </span>
<span class="line">                            cv2<span class="token punctuation">.</span>THRESH_BINARY_INV <span class="token operator">+</span> cv2<span class="token punctuation">.</span>THRESH_OTSU<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å½¢æ€å­¦æ“ä½œ</span></span>
<span class="line">kernel <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span></span>
<span class="line">opening <span class="token operator">=</span> cv2<span class="token punctuation">.</span>morphologyEx<span class="token punctuation">(</span>thresh<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>MORPH_OPEN<span class="token punctuation">,</span> kernel<span class="token punctuation">,</span> iterations<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç¡®å®šèƒŒæ™¯</span></span>
<span class="line">sure_bg <span class="token operator">=</span> cv2<span class="token punctuation">.</span>dilate<span class="token punctuation">(</span>opening<span class="token punctuation">,</span> kernel<span class="token punctuation">,</span> iterations<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è·ç¦»å˜æ¢</span></span>
<span class="line">dist_transform <span class="token operator">=</span> cv2<span class="token punctuation">.</span>distanceTransform<span class="token punctuation">(</span>opening<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>DIST_L2<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">ret<span class="token punctuation">,</span> sure_fg <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>dist_transform<span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token operator">*</span>dist_transform<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ‡è®°</span></span>
<span class="line">sure_fg <span class="token operator">=</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">(</span>sure_fg<span class="token punctuation">)</span></span>
<span class="line">unknown <span class="token operator">=</span> cv2<span class="token punctuation">.</span>subtract<span class="token punctuation">(</span>sure_bg<span class="token punctuation">,</span> sure_fg<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">ret<span class="token punctuation">,</span> markers <span class="token operator">=</span> cv2<span class="token punctuation">.</span>connectedComponents<span class="token punctuation">(</span>sure_fg<span class="token punctuation">)</span></span>
<span class="line">markers <span class="token operator">=</span> markers <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">markers<span class="token punctuation">[</span>unknown <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†æ°´å²­</span></span>
<span class="line">markers <span class="token operator">=</span> cv2<span class="token punctuation">.</span>watershed<span class="token punctuation">(</span>img<span class="token punctuation">,</span> markers<span class="token punctuation">)</span></span>
<span class="line">img<span class="token punctuation">[</span>markers <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,11)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),l(p,{to:"/tutorials/python-ai/cv/08-%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D.html"},{default:o(()=>[...n[0]||(n[0]=[a("ç‰¹å¾åŒ¹é…",-1)])]),_:1})])])}const v=t(r,[["render",k]]),b=JSON.parse('{"path":"/tutorials/python-ai/cv/07-tuxiangfenge.html","title":"å›¾åƒåˆ†å‰²","lang":"zh-CN","frontmatter":{"title":"å›¾åƒåˆ†å‰²"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. é˜ˆå€¼åˆ†å‰²","slug":"_1-é˜ˆå€¼åˆ†å‰²","link":"#_1-é˜ˆå€¼åˆ†å‰²","children":[]},{"level":2,"title":"2. GrabCut","slug":"_2-grabcut","link":"#_2-grabcut","children":[]},{"level":2,"title":"3. åˆ†æ°´å²­ç®—æ³•","slug":"_3-åˆ†æ°´å²­ç®—æ³•","link":"#_3-åˆ†æ°´å²­ç®—æ³•","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/cv/07-å›¾åƒåˆ†å‰².md"}');export{v as comp,b as data};
