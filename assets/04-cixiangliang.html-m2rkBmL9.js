import{_ as e,c as t,d as l,e as s,f as a,b as i,w as o,r as c,o as u}from"./app-DyGs7pMe.js";const r={};function d(k,n){const p=c("RouteLink");return u(),t("div",null,[n[3]||(n[3]=l(`<h1 id="è¯å‘é‡" tabindex="-1"><a class="header-anchor" href="#è¯å‘é‡"><span>è¯å‘é‡</span></a></h1><blockquote><p>æŒæ¡è¯å‘é‡è¡¨ç¤ºå’Œåº”ç”¨</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>ç†è§£è¯å‘é‡æ¦‚å¿µ</li><li>æŒæ¡TF-IDF</li><li>å­¦ä¼šWord2Vec</li><li>äº†è§£GloVeå’ŒFastText</li></ul><h2 id="_1-è¯è¢‹æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#_1-è¯è¢‹æ¨¡å‹"><span>1. è¯è¢‹æ¨¡å‹</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> CountVectorizer</span>
<span class="line"></span>
<span class="line">corpus <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&#39;æˆ‘ çˆ± è‡ªç„¶è¯­è¨€å¤„ç†&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;æ·±åº¦å­¦ä¹  å¾ˆ æœ‰è¶£&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;è‡ªç„¶è¯­è¨€å¤„ç† ä½¿ç”¨ æ·±åº¦å­¦ä¹ &#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">vectorizer <span class="token operator">=</span> CountVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>corpus<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;è¯æ±‡è¡¨:&quot;</span><span class="token punctuation">,</span> vectorizer<span class="token punctuation">.</span>get_feature_names_out<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‘é‡:\\n&quot;</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-tf-idf" tabindex="-1"><a class="header-anchor" href="#_2-tf-idf"><span>2. TF-IDF</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer</span>
<span class="line"></span>
<span class="line">tfidf <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X <span class="token operator">=</span> tfidf<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>corpus<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;TF-IDF:\\n&quot;</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹ç‰¹å¾æƒé‡</span></span>
<span class="line">feature_names <span class="token operator">=</span> tfidf<span class="token punctuation">.</span>get_feature_names_out<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> doc_idx<span class="token punctuation">,</span> doc <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\\næ–‡æ¡£ </span><span class="token interpolation"><span class="token punctuation">{</span>doc_idx<span class="token punctuation">}</span></span><span class="token string">:&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> score <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> score <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  </span><span class="token interpolation"><span class="token punctuation">{</span>feature_names<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>score<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-word2vec" tabindex="-1"><a class="header-anchor" href="#_3-word2vec"><span>3. Word2Vec</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> gensim<span class="token punctuation">.</span>models <span class="token keyword">import</span> Word2Vec</span>
<span class="line"><span class="token keyword">import</span> jieba</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡†å¤‡æ•°æ®</span></span>
<span class="line">sentences <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token builtin">list</span><span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span><span class="token string">&quot;æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token builtin">list</span><span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span><span class="token string">&quot;æ·±åº¦å­¦ä¹ å¾ˆæœ‰è¶£&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token builtin">list</span><span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span><span class="token string">&quot;æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„åˆ†æ”¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">model <span class="token operator">=</span> Word2Vec<span class="token punctuation">(</span>sentences<span class="token punctuation">,</span> </span>
<span class="line">                 vector_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>  <span class="token comment"># è¯å‘é‡ç»´åº¦</span></span>
<span class="line">                 window<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>         <span class="token comment"># ä¸Šä¸‹æ–‡çª—å£</span></span>
<span class="line">                 min_count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>      <span class="token comment"># æœ€å°è¯é¢‘</span></span>
<span class="line">                 workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>        <span class="token comment"># çº¿ç¨‹æ•°</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è·å–è¯å‘é‡</span></span>
<span class="line">vector <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">[</span><span class="token string">&#39;è‡ªç„¶è¯­è¨€å¤„ç†&#39;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;è¯å‘é‡:&quot;</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç›¸ä¼¼è¯</span></span>
<span class="line">similar <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">&#39;æ·±åº¦å­¦ä¹ &#39;</span><span class="token punctuation">,</span> topn<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ç›¸ä¼¼è¯:&quot;</span><span class="token punctuation">,</span> similar<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è¯è¯­ç›¸ä¼¼åº¦</span></span>
<span class="line">similarity <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">.</span>similarity<span class="token punctuation">(</span><span class="token string">&#39;æ·±åº¦å­¦ä¹ &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;æœºå™¨å­¦ä¹ &#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ç›¸ä¼¼åº¦:&quot;</span><span class="token punctuation">,</span> similarity<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¿å­˜å’ŒåŠ è½½</span></span>
<span class="line">model<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;word2vec.model&#39;</span><span class="token punctuation">)</span></span>
<span class="line">model <span class="token operator">=</span> Word2Vec<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&#39;word2vec.model&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-ä½¿ç”¨é¢„è®­ç»ƒè¯å‘é‡" tabindex="-1"><a class="header-anchor" href="#_4-ä½¿ç”¨é¢„è®­ç»ƒè¯å‘é‡"><span>4. ä½¿ç”¨é¢„è®­ç»ƒè¯å‘é‡</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> gensim<span class="token punctuation">.</span>models <span class="token keyword">import</span> KeyedVectors</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span></span>
<span class="line"><span class="token comment"># ä¸‹è½½: https://github.com/Embedding/Chinese-Word-Vectors</span></span>
<span class="line">model <span class="token operator">=</span> KeyedVectors<span class="token punctuation">.</span>load_word2vec_format<span class="token punctuation">(</span><span class="token string">&#39;sgns.wiki.word&#39;</span><span class="token punctuation">,</span> binary<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line">vector <span class="token operator">=</span> model<span class="token punctuation">[</span><span class="token string">&#39;ä¸­å›½&#39;</span><span class="token punctuation">]</span></span>
<span class="line">similar <span class="token operator">=</span> model<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">&#39;ä¸­å›½&#39;</span><span class="token punctuation">,</span> topn<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-fasttext" tabindex="-1"><a class="header-anchor" href="#_5-fasttext"><span>5. FastText</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> gensim<span class="token punctuation">.</span>models <span class="token keyword">import</span> FastText</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒFastText</span></span>
<span class="line">model <span class="token operator">=</span> FastText<span class="token punctuation">(</span>sentences<span class="token punctuation">,</span> </span>
<span class="line">                 vector_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span></span>
<span class="line">                 window<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">                 min_count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è·å–è¯å‘é‡ï¼ˆåŒ…æ‹¬æœªç™»å½•è¯ï¼‰</span></span>
<span class="line">vector <span class="token operator">=</span> model<span class="token punctuation">.</span>wv<span class="token punctuation">[</span><span class="token string">&#39;æœªç™»å½•è¯&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,15)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),i(p,{to:"/tutorials/python-ai/nlp/05-%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB.html"},{default:o(()=>[...n[0]||(n[0]=[a("æ–‡æœ¬åˆ†ç±»",-1)])]),_:1})])])}const v=e(r,[["render",d]]),b=JSON.parse('{"path":"/tutorials/python-ai/nlp/04-cixiangliang.html","title":"è¯å‘é‡","lang":"zh-CN","frontmatter":{"title":"è¯å‘é‡"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. è¯è¢‹æ¨¡å‹","slug":"_1-è¯è¢‹æ¨¡å‹","link":"#_1-è¯è¢‹æ¨¡å‹","children":[]},{"level":2,"title":"2. TF-IDF","slug":"_2-tf-idf","link":"#_2-tf-idf","children":[]},{"level":2,"title":"3. Word2Vec","slug":"_3-word2vec","link":"#_3-word2vec","children":[]},{"level":2,"title":"4. ä½¿ç”¨é¢„è®­ç»ƒè¯å‘é‡","slug":"_4-ä½¿ç”¨é¢„è®­ç»ƒè¯å‘é‡","link":"#_4-ä½¿ç”¨é¢„è®­ç»ƒè¯å‘é‡","children":[]},{"level":2,"title":"5. FastText","slug":"_5-fasttext","link":"#_5-fasttext","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/nlp/04-è¯å‘é‡.md"}');export{v as comp,b as data};
