import{_ as t,c as e,d as l,e as s,f as a,b as o,w as i,r as c,o as u}from"./app-D9dfRPMK.js";const r={};function k(d,n){const p=c("RouteLink");return u(),e("div",null,[n[3]||(n[3]=l(`<h1 id="æƒ…æ„Ÿåˆ†æ" tabindex="-1"><a class="header-anchor" href="#æƒ…æ„Ÿåˆ†æ"><span>æƒ…æ„Ÿåˆ†æ</span></a></h1><blockquote><p>æŒæ¡æƒ…æ„Ÿåˆ†ææŠ€æœ¯å’Œåº”ç”¨</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>ç†è§£æƒ…æ„Ÿåˆ†æ</li><li>æŒæ¡åŸºäºè¯å…¸çš„æ–¹æ³•</li><li>å­¦ä¼šæœºå™¨å­¦ä¹ æ–¹æ³•</li><li>äº†è§£æ·±åº¦å­¦ä¹ æ–¹æ³•</li></ul><h2 id="_1-åŸºäºè¯å…¸çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1-åŸºäºè¯å…¸çš„æ–¹æ³•"><span>1. åŸºäºè¯å…¸çš„æ–¹æ³•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># ä½¿ç”¨SnowNLP</span></span>
<span class="line"><span class="token keyword">from</span> snownlp <span class="token keyword">import</span> SnowNLP</span>
<span class="line"></span>
<span class="line">text <span class="token operator">=</span> <span class="token string">&quot;è¿™éƒ¨ç”µå½±çœŸçš„å¤ªå¥½çœ‹äº†ï¼&quot;</span></span>
<span class="line">s <span class="token operator">=</span> SnowNLP<span class="token punctuation">(</span>text<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æƒ…æ„Ÿå¾—åˆ†: </span><span class="token interpolation"><span class="token punctuation">{</span>s<span class="token punctuation">.</span>sentiments<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># 0-1ä¹‹é—´</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è‡ªå®šä¹‰æƒ…æ„Ÿè¯å…¸</span></span>
<span class="line">positive_words <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;å¥½&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;æ£’&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¼˜ç§€&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å–œæ¬¢&#39;</span><span class="token punctuation">}</span></span>
<span class="line">negative_words <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;å·®&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;çƒ‚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;è®¨åŒ&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å¤±æœ›&#39;</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">sentiment_score</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    words <span class="token operator">=</span> jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>text<span class="token punctuation">)</span></span>
<span class="line">    pos_count <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">for</span> w <span class="token keyword">in</span> words <span class="token keyword">if</span> w <span class="token keyword">in</span> positive_words<span class="token punctuation">)</span></span>
<span class="line">    neg_count <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">for</span> w <span class="token keyword">in</span> words <span class="token keyword">if</span> w <span class="token keyword">in</span> negative_words<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> pos_count <span class="token operator">&gt;</span> neg_count<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;positive&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> neg_count <span class="token operator">&gt;</span> pos_count<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;negative&#39;</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;neutral&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-æœºå™¨å­¦ä¹ æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2-æœºå™¨å­¦ä¹ æ–¹æ³•"><span>2. æœºå™¨å­¦ä¹ æ–¹æ³•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒæ•°æ®</span></span>
<span class="line">train_texts <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&quot;è¿™ä¸ªäº§å“è´¨é‡å¾ˆå¥½&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;æœåŠ¡æ€åº¦å¤ªå·®äº†&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;æ€§ä»·æ¯”å¾ˆé«˜&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;å®Œå…¨ä¸å€¼è¿™ä¸ªä»·æ ¼&quot;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line">train_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 1-æ­£é¢, 0-è´Ÿé¢</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç‰¹å¾æå–</span></span>
<span class="line">vectorizer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X_train <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>train_texts<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">clf <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> train_labels<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹</span></span>
<span class="line">test_text <span class="token operator">=</span> <span class="token string">&quot;è¿™ä¸ªæ‰‹æœºéå¸¸å¥½ç”¨&quot;</span></span>
<span class="line">X_test <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token punctuation">[</span>test_text<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line">prob <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;é¢„æµ‹: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;æ­£é¢&#39;</span> <span class="token keyword">if</span> pred<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token string">&#39;è´Ÿé¢&#39;</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æ¦‚ç‡: è´Ÿé¢=</span><span class="token interpolation"><span class="token punctuation">{</span>prob<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">, æ­£é¢=</span><span class="token interpolation"><span class="token punctuation">{</span>prob<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-ä½¿ç”¨transformers" tabindex="-1"><a class="header-anchor" href="#_3-ä½¿ç”¨transformers"><span>3. ä½¿ç”¨transformers</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> transformers <span class="token keyword">import</span> AutoTokenizer<span class="token punctuation">,</span> AutoModelForSequenceClassification</span>
<span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">model_name <span class="token operator">=</span> <span class="token string">&quot;uer/roberta-base-finetuned-chinaNews-chinese&quot;</span></span>
<span class="line">tokenizer <span class="token operator">=</span> AutoTokenizer<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>model_name<span class="token punctuation">)</span></span>
<span class="line">model <span class="token operator">=</span> AutoModelForSequenceClassification<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>model_name<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹</span></span>
<span class="line">text <span class="token operator">=</span> <span class="token string">&quot;è¿™ä¸ªäº§å“çœŸçš„å¾ˆä¸é”™&quot;</span></span>
<span class="line">inputs <span class="token operator">=</span> tokenizer<span class="token punctuation">(</span>text<span class="token punctuation">,</span> return_tensors<span class="token operator">=</span><span class="token string">&quot;pt&quot;</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> truncation<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">outputs <span class="token operator">=</span> model<span class="token punctuation">(</span><span class="token operator">**</span>inputs<span class="token punctuation">)</span></span>
<span class="line">predictions <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>logits<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æƒ…æ„Ÿé¢„æµ‹:&quot;</span><span class="token punctuation">,</span> predictions<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-å®æˆ˜-ç”µå•†è¯„è®ºåˆ†æ" tabindex="-1"><a class="header-anchor" href="#_4-å®æˆ˜-ç”µå•†è¯„è®ºåˆ†æ"><span>4. å®æˆ˜ï¼šç”µå•†è¯„è®ºåˆ†æ</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½è¯„è®ºæ•°æ®</span></span>
<span class="line">reviews <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;reviews.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰¹é‡æƒ…æ„Ÿåˆ†æ</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> SnowNLP<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>sentiments</span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†ç±»</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;label&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reviews<span class="token punctuation">[</span><span class="token string">&#39;sentiment&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">&#39;positive&#39;</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0.6</span> <span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token string">&#39;negative&#39;</span> <span class="token keyword">if</span> x <span class="token operator">&lt;</span> <span class="token number">0.4</span> <span class="token keyword">else</span> <span class="token string">&#39;neutral&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç»Ÿè®¡</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>reviews<span class="token punctuation">[</span><span class="token string">&#39;label&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–</span></span>
<span class="line">reviews<span class="token punctuation">[</span><span class="token string">&#39;label&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Sentiment Distribution&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,13)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),o(p,{to:"/tutorials/python-ai/nlp/07-%E5%91%BD%E5%90%8D%E5%AE%9E%E4%BD%93%E8%AF%86%E5%88%AB.html"},{default:i(()=>[...n[0]||(n[0]=[a("å‘½åå®ä½“è¯†åˆ«",-1)])]),_:1})])])}const m=t(r,[["render",k]]),b=JSON.parse('{"path":"/tutorials/python-ai/nlp/06-qingganfenxi.html","title":"æƒ…æ„Ÿåˆ†æ","lang":"zh-CN","frontmatter":{"title":"æƒ…æ„Ÿåˆ†æ"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. åŸºäºè¯å…¸çš„æ–¹æ³•","slug":"_1-åŸºäºè¯å…¸çš„æ–¹æ³•","link":"#_1-åŸºäºè¯å…¸çš„æ–¹æ³•","children":[]},{"level":2,"title":"2. æœºå™¨å­¦ä¹ æ–¹æ³•","slug":"_2-æœºå™¨å­¦ä¹ æ–¹æ³•","link":"#_2-æœºå™¨å­¦ä¹ æ–¹æ³•","children":[]},{"level":2,"title":"3. ä½¿ç”¨transformers","slug":"_3-ä½¿ç”¨transformers","link":"#_3-ä½¿ç”¨transformers","children":[]},{"level":2,"title":"4. å®æˆ˜ï¼šç”µå•†è¯„è®ºåˆ†æ","slug":"_4-å®æˆ˜-ç”µå•†è¯„è®ºåˆ†æ","link":"#_4-å®æˆ˜-ç”µå•†è¯„è®ºåˆ†æ","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/nlp/06-æƒ…æ„Ÿåˆ†æ.md"}');export{m as comp,b as data};
