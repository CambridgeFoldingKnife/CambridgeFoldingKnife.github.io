import{_ as p,c as l,d as t,e as s,f as a,b as i,w as o,r as c,o as r}from"./app-DyGs7pMe.js";const u={};function d(k,n){const e=c("RouteLink");return r(),l("div",null,[n[3]||(n[3]=t(`<h1 id="ç›®æ ‡æ£€æµ‹ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#ç›®æ ‡æ£€æµ‹ç®—æ³•"><span>ç›®æ ‡æ£€æµ‹ç®—æ³•</span></a></h1><blockquote><p>æŒæ¡æ·±åº¦å­¦ä¹ ç›®æ ‡æ£€æµ‹ç®—æ³•</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>ç†è§£YOLOç®—æ³•</li><li>å­¦ä¼šä½¿ç”¨YOLOv5</li><li>äº†è§£å…¶ä»–æ£€æµ‹ç®—æ³•</li><li>æŒæ¡æ¨¡å‹éƒ¨ç½²</li></ul><h2 id="_1-yolov5-ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_1-yolov5-ä½¿ç”¨"><span>1. YOLOv5 ä½¿ç”¨</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ¨¡å‹</span></span>
<span class="line">model <span class="token operator">=</span> torch<span class="token punctuation">.</span>hub<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&#39;ultralytics/yolov5&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;yolov5s&#39;</span><span class="token punctuation">,</span> pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¨ç†</span></span>
<span class="line">img <span class="token operator">=</span> <span class="token string">&#39;image.jpg&#39;</span></span>
<span class="line">results <span class="token operator">=</span> model<span class="token punctuation">(</span>img<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ˜¾ç¤ºç»“æœ</span></span>
<span class="line">results<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰“å°ç»“æœ</span></span>
<span class="line">results<span class="token punctuation">.</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¿å­˜ç»“æœ</span></span>
<span class="line">results<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-å®æ—¶æ£€æµ‹" tabindex="-1"><a class="header-anchor" href="#_2-å®æ—¶æ£€æµ‹"><span>2. å®æ—¶æ£€æµ‹</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ¨¡å‹</span></span>
<span class="line">model <span class="token operator">=</span> torch<span class="token punctuation">.</span>hub<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&#39;ultralytics/yolov5&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;yolov5s&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰“å¼€æ‘„åƒå¤´</span></span>
<span class="line">cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">    ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> ret<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">break</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ£€æµ‹</span></span>
<span class="line">    results <span class="token operator">=</span> model<span class="token punctuation">(</span>frame<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ¸²æŸ“ç»“æœ</span></span>
<span class="line">    rendered <span class="token operator">=</span> results<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ˜¾ç¤º</span></span>
<span class="line">    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">&#39;YOLOv5&#39;</span><span class="token punctuation">,</span> rendered<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">&#39;q&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">break</span></span>
<span class="line"></span>
<span class="line">cap<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-è‡ªå®šä¹‰è®­ç»ƒ" tabindex="-1"><a class="header-anchor" href="#_3-è‡ªå®šä¹‰è®­ç»ƒ"><span>3. è‡ªå®šä¹‰è®­ç»ƒ</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># å‡†å¤‡æ•°æ®é›†ï¼ˆYOLOæ ¼å¼ï¼‰</span></span>
<span class="line"><span class="token comment"># data.yaml é…ç½®æ–‡ä»¶</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒ</span></span>
<span class="line">!python train<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>img <span class="token number">640</span> <span class="token operator">-</span><span class="token operator">-</span>batch <span class="token number">16</span> <span class="token operator">-</span><span class="token operator">-</span>epochs <span class="token number">50</span> \\</span>
<span class="line">                 <span class="token operator">-</span><span class="token operator">-</span>data data<span class="token punctuation">.</span>yaml <span class="token operator">-</span><span class="token operator">-</span>weights yolov5s<span class="token punctuation">.</span>pt</span>
<span class="line"></span>
<span class="line"><span class="token comment"># éªŒè¯</span></span>
<span class="line">!python val<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>weights runs<span class="token operator">/</span>train<span class="token operator">/</span>exp<span class="token operator">/</span>weights<span class="token operator">/</span>best<span class="token punctuation">.</span>pt \\</span>
<span class="line">               <span class="token operator">-</span><span class="token operator">-</span>data data<span class="token punctuation">.</span>yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¨ç†</span></span>
<span class="line">!python detect<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>weights runs<span class="token operator">/</span>train<span class="token operator">/</span>exp<span class="token operator">/</span>weights<span class="token operator">/</span>best<span class="token punctuation">.</span>pt \\</span>
<span class="line">                  <span class="token operator">-</span><span class="token operator">-</span>source test<span class="token punctuation">.</span>jpg</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-å…¶ä»–ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_4-å…¶ä»–ç®—æ³•"><span>4. å…¶ä»–ç®—æ³•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Faster R-CNN</span></span>
<span class="line"><span class="token keyword">import</span> torchvision</span>
<span class="line">model <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>fasterrcnn_resnet50_fpn<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># RetinaNet</span></span>
<span class="line">model <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>retinanet_resnet50_fpn<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨</span></span>
<span class="line">model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    predictions <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,13)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),i(e,{to:"/tutorials/python-ai/cv/12-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B.html"},{default:o(()=>[...n[0]||(n[0]=[a("å®æˆ˜æ¡ˆä¾‹",-1)])]),_:1})])])}const m=p(u,[["render",d]]),b=JSON.parse('{"path":"/tutorials/python-ai/cv/11-mubiaojiancesuanfa.html","title":"ç›®æ ‡æ£€æµ‹ç®—æ³•","lang":"zh-CN","frontmatter":{"title":"ç›®æ ‡æ£€æµ‹ç®—æ³•"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. YOLOv5 ä½¿ç”¨","slug":"_1-yolov5-ä½¿ç”¨","link":"#_1-yolov5-ä½¿ç”¨","children":[]},{"level":2,"title":"2. å®æ—¶æ£€æµ‹","slug":"_2-å®æ—¶æ£€æµ‹","link":"#_2-å®æ—¶æ£€æµ‹","children":[]},{"level":2,"title":"3. è‡ªå®šä¹‰è®­ç»ƒ","slug":"_3-è‡ªå®šä¹‰è®­ç»ƒ","link":"#_3-è‡ªå®šä¹‰è®­ç»ƒ","children":[]},{"level":2,"title":"4. å…¶ä»–ç®—æ³•","slug":"_4-å…¶ä»–ç®—æ³•","link":"#_4-å…¶ä»–ç®—æ³•","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/cv/11-ç›®æ ‡æ£€æµ‹ç®—æ³•.md"}');export{m as comp,b as data};
