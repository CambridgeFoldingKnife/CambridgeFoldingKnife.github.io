import{_ as p,c as l,d as t,e as a,f as n,b as o,w as c,r as i,o as d}from"./app-D9dfRPMK.js";const k={};function r(u,s){const e=i("RouteLink");return d(),l("div",null,[s[3]||(s[3]=t(`<h1 id="约束与数据完整性" tabindex="-1"><a class="header-anchor" href="#约束与数据完整性"><span>约束与数据完整性</span></a></h1><blockquote><p>约束是保证数据准确性和一致性的重要机制。本章将深入讲解MySQL中的各种约束类型及其应用。</p></blockquote><h2 id="📋-本章目录" tabindex="-1"><a class="header-anchor" href="#📋-本章目录"><span>📋 本章目录</span></a></h2><ul><li><a href="#%E4%B8%80%E7%BA%A6%E6%9D%9F%E6%A6%82%E8%BF%B0">一、约束概述</a></li><li><a href="#%E4%BA%8C%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F">二、主键约束</a></li><li><a href="#%E4%B8%89%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F">三、外键约束</a></li><li><a href="#%E5%9B%9B%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F">四、唯一约束</a></li><li><a href="#%E4%BA%94%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F">五、非空约束</a></li><li><a href="#%E5%85%AD%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F">六、默认约束</a></li><li><a href="#%E4%B8%83%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F">七、检查约束</a></li><li><a href="#%E5%85%AB%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B">八、综合应用案例</a></li></ul><hr><h2 id="一、约束概述" tabindex="-1"><a class="header-anchor" href="#一、约束概述"><span>一、约束概述</span></a></h2><h3 id="_1-1-什么是约束" tabindex="-1"><a class="header-anchor" href="#_1-1-什么是约束"><span>1.1 什么是约束？</span></a></h3><p><strong>约束（Constraint）</strong> 是作用于表中字段上的规则，用于限制存储在表中的数据，保证数据的正确性、有效性和完整性。</p><h3 id="_1-2-约束的分类" tabindex="-1"><a class="header-anchor" href="#_1-2-约束的分类"><span>1.2 约束的分类</span></a></h3><table><thead><tr><th>约束类型</th><th>关键字</th><th>说明</th></tr></thead><tbody><tr><td><strong>主键约束</strong></td><td><code>PRIMARY KEY</code></td><td>唯一标识，非空且唯一</td></tr><tr><td><strong>外键约束</strong></td><td><code>FOREIGN KEY</code></td><td>建立表间关系，保证引用完整性</td></tr><tr><td><strong>唯一约束</strong></td><td><code>UNIQUE</code></td><td>保证数据唯一，可以为NULL</td></tr><tr><td><strong>非空约束</strong></td><td><code>NOT NULL</code></td><td>不允许为NULL</td></tr><tr><td><strong>默认约束</strong></td><td><code>DEFAULT</code></td><td>设置默认值</td></tr><tr><td><strong>检查约束</strong></td><td><code>CHECK</code></td><td>保证字段值满足条件（MySQL 8.0.16+）</td></tr></tbody></table><h3 id="_1-3-约束的作用" tabindex="-1"><a class="header-anchor" href="#_1-3-约束的作用"><span>1.3 约束的作用</span></a></h3><ul><li>✅ <strong>保证数据准确性</strong>：防止非法数据插入</li><li>✅ <strong>维护数据一致性</strong>：确保数据符合业务规则</li><li>✅ <strong>建立表间关系</strong>：通过外键维护关联</li><li>✅ <strong>提高数据质量</strong>：在数据库层面把关</li></ul><hr><h2 id="二、主键约束" tabindex="-1"><a class="header-anchor" href="#二、主键约束"><span>二、主键约束</span></a></h2><h3 id="_2-1-主键的特点" tabindex="-1"><a class="header-anchor" href="#_2-1-主键的特点"><span>2.1 主键的特点</span></a></h3><ul><li>🔑 <strong>唯一标识</strong>：每条记录的主键值必须唯一</li><li>❌ <strong>非空</strong>：主键值不能为NULL</li><li>🎯 <strong>一张表只能有一个主键</strong></li><li>⚡ <strong>自动创建索引</strong>：提高查询效率</li></ul><h3 id="_2-2-创建主键" tabindex="-1"><a class="header-anchor" href="#_2-2-创建主键"><span>2.2 创建主键</span></a></h3><h4 id="方式一-创建表时定义" tabindex="-1"><a class="header-anchor" href="#方式一-创建表时定义"><span>方式一：创建表时定义</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 单字段主键</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> students <span class="token punctuation">(</span></span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span></span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    age <span class="token keyword">INT</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 或使用AUTO_INCREMENT自增</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> students <span class="token punctuation">(</span></span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    age <span class="token keyword">INT</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 在字段列表后定义</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> students <span class="token punctuation">(</span></span>
<span class="line">    id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    age <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 联合主键（多个字段组合）</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student_courses <span class="token punctuation">(</span></span>
<span class="line">    student_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    course_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    score <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>student_id<span class="token punctuation">,</span> course_id<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="方式二-修改表添加主键" tabindex="-1"><a class="header-anchor" href="#方式二-修改表添加主键"><span>方式二：修改表添加主键</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 添加主键</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students <span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 添加自增主键</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students </span>
<span class="line"><span class="token keyword">MODIFY</span> id <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-删除主键" tabindex="-1"><a class="header-anchor" href="#_2-3-删除主键"><span>2.3 删除主键</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 先删除自增属性</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students <span class="token keyword">MODIFY</span> id <span class="token keyword">INT</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 再删除主键</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students <span class="token keyword">DROP</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-auto-increment自增" tabindex="-1"><a class="header-anchor" href="#_2-4-auto-increment自增"><span>2.4 AUTO_INCREMENT自增</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 创建自增主键</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orders <span class="token punctuation">(</span></span>
<span class="line">    order_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    customer_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    order_date <span class="token keyword">DATE</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 插入数据（自动生成ID）</span></span>
<span class="line"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orders <span class="token punctuation">(</span>customer_name<span class="token punctuation">,</span> order_date<span class="token punctuation">)</span> </span>
<span class="line"><span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2024-01-01&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 指定起始值</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> orders <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 查询下一个自增值</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token keyword">AUTO_INCREMENT</span> </span>
<span class="line"><span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span> </span>
<span class="line"><span class="token keyword">WHERE</span> TABLE_NAME <span class="token operator">=</span> <span class="token string">&#39;orders&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="三、外键约束" tabindex="-1"><a class="header-anchor" href="#三、外键约束"><span>三、外键约束</span></a></h2><h3 id="_3-1-外键的作用" tabindex="-1"><a class="header-anchor" href="#_3-1-外键的作用"><span>3.1 外键的作用</span></a></h3><p>外键用于建立两个表之间的连接，保证数据的<strong>引用完整性</strong>。</p><p><strong>示例关系</strong>：</p><ul><li>员工表（employees）：员工信息</li><li>部门表（departments）：部门信息</li><li>关系：员工属于某个部门</li></ul><h3 id="_3-2-创建外键" tabindex="-1"><a class="header-anchor" href="#_3-2-创建外键"><span>3.2 创建外键</span></a></h3><h4 id="方式一-创建表时定义-1" tabindex="-1"><a class="header-anchor" href="#方式一-创建表时定义-1"><span>方式一：创建表时定义</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 先创建父表（被引用的表）</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> departments <span class="token punctuation">(</span></span>
<span class="line">    dept_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    dept_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 再创建子表（引用的表）</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees <span class="token punctuation">(</span></span>
<span class="line">    emp_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    emp_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    dept_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> departments<span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="方式二-修改表添加外键" tabindex="-1"><a class="header-anchor" href="#方式二-修改表添加外键"><span>方式二：修改表添加外键</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 添加外键约束</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees </span>
<span class="line"><span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> fk_emp_dept </span>
<span class="line"><span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> departments<span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-外键的级联操作" tabindex="-1"><a class="header-anchor" href="#_3-3-外键的级联操作"><span>3.3 外键的级联操作</span></a></h3><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td><code>CASCADE</code></td><td>级联操作（父表删除/更新时，子表同步操作）</td></tr><tr><td><code>SET NULL</code></td><td>父表删除/更新时，子表外键设为NULL</td></tr><tr><td><code>RESTRICT</code></td><td>有子表记录时，拒绝父表删除/更新（默认）</td></tr><tr><td><code>NO ACTION</code></td><td>同RESTRICT</td></tr><tr><td><code>SET DEFAULT</code></td><td>设置为默认值（InnoDB不支持）</td></tr></tbody></table><p><strong>示例：</strong></p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees <span class="token punctuation">(</span></span>
<span class="line">    emp_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    emp_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    dept_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> departments<span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span>      <span class="token comment">-- 删除部门时，删除该部门所有员工</span></span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span>      <span class="token comment">-- 更新部门ID时，同步更新员工表</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 或者设置为NULL</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees <span class="token punctuation">(</span></span>
<span class="line">    emp_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    emp_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    dept_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> departments<span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">SET</span> <span class="token boolean">NULL</span>     <span class="token comment">-- 删除部门时，员工的dept_id设为NULL</span></span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">SET</span> <span class="token boolean">NULL</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-删除外键" tabindex="-1"><a class="header-anchor" href="#_3-4-删除外键"><span>3.4 删除外键</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 删除外键（需要知道外键名称）</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> fk_emp_dept<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 查看外键名称</span></span>
<span class="line"><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5-外键使用注意事项" tabindex="-1"><a class="header-anchor" href="#_3-5-外键使用注意事项"><span>3.5 外键使用注意事项</span></a></h3><p>⚠️ <strong>注意</strong>：</p><ol><li>外键字段的数据类型必须与主表主键一致</li><li>外键字段可以为NULL（除非设置NOT NULL）</li><li>只有InnoDB引擎支持外键</li><li>外键会影响性能，大型系统可考虑在应用层维护关系</li></ol><hr><h2 id="四、唯一约束" tabindex="-1"><a class="header-anchor" href="#四、唯一约束"><span>四、唯一约束</span></a></h2><h3 id="_4-1-唯一约束的特点" tabindex="-1"><a class="header-anchor" href="#_4-1-唯一约束的特点"><span>4.1 唯一约束的特点</span></a></h3><ul><li>✅ 保证字段值唯一</li><li>✅ 可以为NULL（NULL不参与唯一性检查）</li><li>✅ 一张表可以有多个唯一约束</li><li>⚡ 自动创建唯一索引</li></ul><h3 id="_4-2-创建唯一约束" tabindex="-1"><a class="header-anchor" href="#_4-2-创建唯一约束"><span>4.2 创建唯一约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 方式一：创建表时定义</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span></span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>      <span class="token comment">-- 唯一约束</span></span>
<span class="line">    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>                 <span class="token comment">-- 唯一约束</span></span>
<span class="line">    phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>phone<span class="token punctuation">)</span>                             <span class="token comment">-- 或在后面定义</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 联合唯一约束</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_roles <span class="token punctuation">(</span></span>
<span class="line">    user_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    role_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> role_id<span class="token punctuation">)</span>  <span class="token comment">-- 组合必须唯一</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 方式二：修改表添加</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">ADD</span> <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 指定约束名</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users </span>
<span class="line"><span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> uk_email <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-删除唯一约束" tabindex="-1"><a class="header-anchor" href="#_4-3-删除唯一约束"><span>4.3 删除唯一约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 删除唯一约束（通过索引名）</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> email<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 删除命名的约束</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> uk_email<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-4-主键-vs-唯一约束" tabindex="-1"><a class="header-anchor" href="#_4-4-主键-vs-唯一约束"><span>4.4 主键 vs 唯一约束</span></a></h3><table><thead><tr><th>特性</th><th>主键 PRIMARY KEY</th><th>唯一约束 UNIQUE</th></tr></thead><tbody><tr><td>唯一性</td><td>✅</td><td>✅</td></tr><tr><td>可为NULL</td><td>❌</td><td>✅</td></tr><tr><td>数量限制</td><td>一张表只能一个</td><td>可以有多个</td></tr><tr><td>自动创建索引</td><td>✅</td><td>✅</td></tr></tbody></table><hr><h2 id="五、非空约束" tabindex="-1"><a class="header-anchor" href="#五、非空约束"><span>五、非空约束</span></a></h2><h3 id="_5-1-非空约束的作用" tabindex="-1"><a class="header-anchor" href="#_5-1-非空约束的作用"><span>5.1 非空约束的作用</span></a></h3><ul><li>❌ 不允许字段值为NULL</li><li>✅ 保证数据完整性</li></ul><h3 id="_5-2-创建非空约束" tabindex="-1"><a class="header-anchor" href="#_5-2-创建非空约束"><span>5.2 创建非空约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 创建表时定义</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees <span class="token punctuation">(</span></span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span></span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>        <span class="token comment">-- 非空</span></span>
<span class="line">    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>      <span class="token comment">-- 非空</span></span>
<span class="line">    phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>                 <span class="token comment">-- 可为空</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 修改表添加非空约束</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees <span class="token keyword">MODIFY</span> phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-删除非空约束" tabindex="-1"><a class="header-anchor" href="#_5-3-删除非空约束"><span>5.3 删除非空约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 修改字段为允许NULL</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees <span class="token keyword">MODIFY</span> phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="六、默认约束" tabindex="-1"><a class="header-anchor" href="#六、默认约束"><span>六、默认约束</span></a></h2><h3 id="_6-1-默认约束的作用" tabindex="-1"><a class="header-anchor" href="#_6-1-默认约束的作用"><span>6.1 默认约束的作用</span></a></h3><p>当插入数据时未指定字段值，自动使用默认值。</p><h3 id="_6-2-创建默认约束" tabindex="-1"><a class="header-anchor" href="#_6-2-创建默认约束"><span>6.2 创建默认约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 创建表时定义</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> articles <span class="token punctuation">(</span></span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    title <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    content <span class="token keyword">TEXT</span><span class="token punctuation">,</span></span>
<span class="line">    view_count <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">,</span>              <span class="token comment">-- 默认为0</span></span>
<span class="line">    <span class="token keyword">status</span> <span class="token keyword">TINYINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">,</span>              <span class="token comment">-- 默认为1</span></span>
<span class="line">    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>          <span class="token comment">-- 默认当前时间</span></span>
<span class="line">    updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> </span>
<span class="line">               <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span>                   <span class="token comment">-- 自动更新</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 修改表添加默认值</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> articles </span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> <span class="token keyword">status</span> <span class="token keyword">SET</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-删除默认约束" tabindex="-1"><a class="header-anchor" href="#_6-3-删除默认约束"><span>6.3 删除默认约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> articles </span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> <span class="token keyword">status</span> <span class="token keyword">DROP</span> <span class="token keyword">DEFAULT</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-4-常用默认值" tabindex="-1"><a class="header-anchor" href="#_6-4-常用默认值"><span>6.4 常用默认值</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 数值默认值</span></span>
<span class="line">price <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token number">0.00</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 字符串默认值</span></span>
<span class="line">gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;男&#39;</span></span>
<span class="line"><span class="token keyword">status</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;active&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 日期时间默认值</span></span>
<span class="line">created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span></span>
<span class="line">updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 布尔默认值（TINYINT）</span></span>
<span class="line">is_deleted <span class="token keyword">TINYINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="七、检查约束" tabindex="-1"><a class="header-anchor" href="#七、检查约束"><span>七、检查约束</span></a></h2><h3 id="_7-1-检查约束的作用" tabindex="-1"><a class="header-anchor" href="#_7-1-检查约束的作用"><span>7.1 检查约束的作用</span></a></h3><p>检查约束用于限制字段值必须满足指定条件（MySQL 8.0.16+支持）。</p><h3 id="_7-2-创建检查约束" tabindex="-1"><a class="header-anchor" href="#_7-2-创建检查约束"><span>7.2 创建检查约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 创建表时定义</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees <span class="token punctuation">(</span></span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    age <span class="token keyword">INT</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;=</span> <span class="token number">18</span> <span class="token operator">AND</span> age <span class="token operator">&lt;=</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              <span class="token comment">-- 年龄范围</span></span>
<span class="line">    salary <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>salary <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              <span class="token comment">-- 薪资大于0</span></span>
<span class="line">    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>gender <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token comment">-- 性别限制</span></span>
<span class="line">    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">CONSTRAINT</span> chk_email <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>email <span class="token operator">LIKE</span> <span class="token string">&#39;%@%.%&#39;</span><span class="token punctuation">)</span>       <span class="token comment">-- 邮箱格式</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 修改表添加检查约束</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees </span>
<span class="line"><span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> chk_age <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>age <span class="token operator">BETWEEN</span> <span class="token number">18</span> <span class="token operator">AND</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-删除检查约束" tabindex="-1"><a class="header-anchor" href="#_7-3-删除检查约束"><span>7.3 删除检查约束</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees <span class="token keyword">DROP</span> <span class="token keyword">CHECK</span> chk_age<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_7-4-常用检查约束示例" tabindex="-1"><a class="header-anchor" href="#_7-4-常用检查约束示例"><span>7.4 常用检查约束示例</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 范围检查</span></span>
<span class="line">age <span class="token keyword">INT</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">AND</span> age <span class="token operator">&lt;=</span> <span class="token number">150</span><span class="token punctuation">)</span></span>
<span class="line">score <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">AND</span> score <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 枚举检查</span></span>
<span class="line"><span class="token keyword">status</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span><span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;active&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;inactive&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;banned&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">level</span> <span class="token keyword">TINYINT</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span><span class="token keyword">level</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 格式检查</span></span>
<span class="line">phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>phone <span class="token operator">REGEXP</span> <span class="token string">&#39;^1[3-9][0-9]{9}$&#39;</span><span class="token punctuation">)</span></span>
<span class="line">email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>email <span class="token operator">LIKE</span> <span class="token string">&#39;%@%.%&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 逻辑检查</span></span>
<span class="line">start_date <span class="token keyword">DATE</span><span class="token punctuation">,</span></span>
<span class="line">end_date <span class="token keyword">DATE</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token keyword">CHECK</span> <span class="token punctuation">(</span>end_date <span class="token operator">&gt;</span> start_date<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="八、综合应用案例" tabindex="-1"><a class="header-anchor" href="#八、综合应用案例"><span>八、综合应用案例</span></a></h2><h3 id="案例1-完整的用户表" tabindex="-1"><a class="header-anchor" href="#案例1-完整的用户表"><span>案例1：完整的用户表</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span></span>
<span class="line">    <span class="token comment">-- 主键约束 + 自增</span></span>
<span class="line">    user_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;用户ID&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 非空 + 唯一约束</span></span>
<span class="line">    username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;用户名&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 非空约束</span></span>
<span class="line">    password <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;密码&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 唯一约束 + 检查约束</span></span>
<span class="line">    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">UNIQUE</span> </span>
<span class="line">        <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>email <span class="token operator">LIKE</span> <span class="token string">&#39;%@%.%&#39;</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;邮箱&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 唯一约束 + 检查约束</span></span>
<span class="line">    phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">UNIQUE</span> </span>
<span class="line">        <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>phone <span class="token operator">REGEXP</span> <span class="token string">&#39;^1[3-9][0-9]{9}$&#39;</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;手机号&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 检查约束</span></span>
<span class="line">    age <span class="token keyword">INT</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;=</span> <span class="token number">18</span> <span class="token operator">AND</span> age <span class="token operator">&lt;=</span> <span class="token number">120</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;年龄&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 检查约束（枚举）</span></span>
<span class="line">    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;男&#39;</span> </span>
<span class="line">        <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>gender <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;性别&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 默认约束</span></span>
<span class="line">    <span class="token keyword">status</span> <span class="token keyword">TINYINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span> </span>
<span class="line">        <span class="token keyword">CHECK</span> <span class="token punctuation">(</span><span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;状态：0-禁用，1-启用&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">-- 默认约束（时间戳）</span></span>
<span class="line">    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;创建时间&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> </span>
<span class="line">               <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;更新时间&#39;</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;用户表&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例2-订单和订单详情-外键" tabindex="-1"><a class="header-anchor" href="#案例2-订单和订单详情-外键"><span>案例2：订单和订单详情（外键）</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 订单表</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orders <span class="token punctuation">(</span></span>
<span class="line">    order_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    user_id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    order_no <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span></span>
<span class="line">    total_amount <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>total_amount <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">status</span> <span class="token keyword">TINYINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span><span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    order_date <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> users<span class="token punctuation">(</span>user_id<span class="token punctuation">)</span> </span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">RESTRICT</span> </span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;订单表&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 订单详情表</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> order_items <span class="token punctuation">(</span></span>
<span class="line">    item_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    order_id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    product_id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    quantity <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>quantity <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    price <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>price <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    subtotal <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>subtotal <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>order_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> orders<span class="token punctuation">(</span>order_id<span class="token punctuation">)</span> </span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> </span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;订单详情表&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例3-学生选课系统" tabindex="-1"><a class="header-anchor" href="#案例3-学生选课系统"><span>案例3：学生选课系统</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 学生表</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> students <span class="token punctuation">(</span></span>
<span class="line">    student_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    student_no <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span></span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>gender <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    birth_date <span class="token keyword">DATE</span><span class="token punctuation">,</span></span>
<span class="line">    major <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 课程表</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> courses <span class="token punctuation">(</span></span>
<span class="line">    course_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    course_no <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span></span>
<span class="line">    course_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    credits <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>credits <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    max_students <span class="token keyword">INT</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>max_students <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 选课表（联合主键 + 外键）</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> enrollments <span class="token punctuation">(</span></span>
<span class="line">    student_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    course_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    score <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">AND</span> score <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    enroll_date <span class="token keyword">DATE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>student_id<span class="token punctuation">,</span> course_id<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>student_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> students<span class="token punctuation">(</span>student_id<span class="token punctuation">)</span> </span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>course_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> courses<span class="token punctuation">(</span>course_id<span class="token punctuation">)</span> </span>
<span class="line">        <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="九、本章总结" tabindex="-1"><a class="header-anchor" href="#九、本章总结"><span>九、本章总结</span></a></h2><h3 id="核心要点" tabindex="-1"><a class="header-anchor" href="#核心要点"><span>核心要点</span></a></h3><ol><li><strong>主键约束</strong>：唯一标识，非空且唯一，一表一个</li><li><strong>外键约束</strong>：维护表间关系，保证引用完整性</li><li><strong>唯一约束</strong>：保证数据唯一，可以为NULL</li><li><strong>非空约束</strong>：字段值不能为NULL</li><li><strong>默认约束</strong>：未指定值时使用默认值</li><li><strong>检查约束</strong>：限制字段值满足条件</li></ol><h3 id="约束使用建议" tabindex="-1"><a class="header-anchor" href="#约束使用建议"><span>约束使用建议</span></a></h3><ul><li>✅ 合理使用约束保证数据质量</li><li>✅ 主键尽量使用自增整数</li><li>✅ 外键谨慎使用，注意性能影响</li><li>✅ 唯一约束用于保证业务唯一性</li><li>✅ 重要字段添加非空约束</li><li>✅ 检查约束减轻应用层负担</li></ul><hr><h2 id="练习题" tabindex="-1"><a class="header-anchor" href="#练习题"><span>练习题</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 1. 创建员工表，包含各种约束</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees <span class="token punctuation">(</span></span>
<span class="line">    emp_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></span>
<span class="line">    emp_no <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span></span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>email <span class="token operator">LIKE</span> <span class="token string">&#39;%@%.%&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    age <span class="token keyword">INT</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;=</span> <span class="token number">18</span> <span class="token operator">AND</span> age <span class="token operator">&lt;=</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    salary <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>salary <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    dept_id <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">status</span> <span class="token keyword">TINYINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span><span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> departments<span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 2. 插入测试数据</span></span>
<span class="line"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> employees <span class="token punctuation">(</span>emp_no<span class="token punctuation">,</span> name<span class="token punctuation">,</span> email<span class="token punctuation">,</span> age<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> dept_id<span class="token punctuation">)</span> </span>
<span class="line"><span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;E001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;zhangsan@example.com&#39;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 3. 尝试插入违反约束的数据（会失败）</span></span>
<span class="line"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> employees <span class="token punctuation">(</span>emp_no<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> </span>
<span class="line"><span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;E001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 违反唯一约束和年龄检查</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,101)),a("p",null,[a("strong",null,[s[1]||(s[1]=n("下一章：",-1)),o(e,{to:"/tutorials/database/mysql/%E7%AC%AC02%E7%AB%A0-%E8%BF%9B%E9%98%B6%E7%AF%87/05-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E4%B8%8E%E8%BF%9E%E6%8E%A5.html"},{default:c(()=>[...s[0]||(s[0]=[n("第05章 - 多表查询与连接",-1)])]),_:1})]),s[2]||(s[2]=n(" →",-1))])])}const v=p(k,[["render",r]]),b=JSON.parse('{"path":"/tutorials/database/mysql/di02zhang-jinjiepian/04-yueshuyushujuwanzhengxing.html","title":"约束与数据完整性","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"📋 本章目录","slug":"📋-本章目录","link":"#📋-本章目录","children":[]},{"level":2,"title":"一、约束概述","slug":"一、约束概述","link":"#一、约束概述","children":[{"level":3,"title":"1.1 什么是约束？","slug":"_1-1-什么是约束","link":"#_1-1-什么是约束","children":[]},{"level":3,"title":"1.2 约束的分类","slug":"_1-2-约束的分类","link":"#_1-2-约束的分类","children":[]},{"level":3,"title":"1.3 约束的作用","slug":"_1-3-约束的作用","link":"#_1-3-约束的作用","children":[]}]},{"level":2,"title":"二、主键约束","slug":"二、主键约束","link":"#二、主键约束","children":[{"level":3,"title":"2.1 主键的特点","slug":"_2-1-主键的特点","link":"#_2-1-主键的特点","children":[]},{"level":3,"title":"2.2 创建主键","slug":"_2-2-创建主键","link":"#_2-2-创建主键","children":[]},{"level":3,"title":"2.3 删除主键","slug":"_2-3-删除主键","link":"#_2-3-删除主键","children":[]},{"level":3,"title":"2.4 AUTO_INCREMENT自增","slug":"_2-4-auto-increment自增","link":"#_2-4-auto-increment自增","children":[]}]},{"level":2,"title":"三、外键约束","slug":"三、外键约束","link":"#三、外键约束","children":[{"level":3,"title":"3.1 外键的作用","slug":"_3-1-外键的作用","link":"#_3-1-外键的作用","children":[]},{"level":3,"title":"3.2 创建外键","slug":"_3-2-创建外键","link":"#_3-2-创建外键","children":[]},{"level":3,"title":"3.3 外键的级联操作","slug":"_3-3-外键的级联操作","link":"#_3-3-外键的级联操作","children":[]},{"level":3,"title":"3.4 删除外键","slug":"_3-4-删除外键","link":"#_3-4-删除外键","children":[]},{"level":3,"title":"3.5 外键使用注意事项","slug":"_3-5-外键使用注意事项","link":"#_3-5-外键使用注意事项","children":[]}]},{"level":2,"title":"四、唯一约束","slug":"四、唯一约束","link":"#四、唯一约束","children":[{"level":3,"title":"4.1 唯一约束的特点","slug":"_4-1-唯一约束的特点","link":"#_4-1-唯一约束的特点","children":[]},{"level":3,"title":"4.2 创建唯一约束","slug":"_4-2-创建唯一约束","link":"#_4-2-创建唯一约束","children":[]},{"level":3,"title":"4.3 删除唯一约束","slug":"_4-3-删除唯一约束","link":"#_4-3-删除唯一约束","children":[]},{"level":3,"title":"4.4 主键 vs 唯一约束","slug":"_4-4-主键-vs-唯一约束","link":"#_4-4-主键-vs-唯一约束","children":[]}]},{"level":2,"title":"五、非空约束","slug":"五、非空约束","link":"#五、非空约束","children":[{"level":3,"title":"5.1 非空约束的作用","slug":"_5-1-非空约束的作用","link":"#_5-1-非空约束的作用","children":[]},{"level":3,"title":"5.2 创建非空约束","slug":"_5-2-创建非空约束","link":"#_5-2-创建非空约束","children":[]},{"level":3,"title":"5.3 删除非空约束","slug":"_5-3-删除非空约束","link":"#_5-3-删除非空约束","children":[]}]},{"level":2,"title":"六、默认约束","slug":"六、默认约束","link":"#六、默认约束","children":[{"level":3,"title":"6.1 默认约束的作用","slug":"_6-1-默认约束的作用","link":"#_6-1-默认约束的作用","children":[]},{"level":3,"title":"6.2 创建默认约束","slug":"_6-2-创建默认约束","link":"#_6-2-创建默认约束","children":[]},{"level":3,"title":"6.3 删除默认约束","slug":"_6-3-删除默认约束","link":"#_6-3-删除默认约束","children":[]},{"level":3,"title":"6.4 常用默认值","slug":"_6-4-常用默认值","link":"#_6-4-常用默认值","children":[]}]},{"level":2,"title":"七、检查约束","slug":"七、检查约束","link":"#七、检查约束","children":[{"level":3,"title":"7.1 检查约束的作用","slug":"_7-1-检查约束的作用","link":"#_7-1-检查约束的作用","children":[]},{"level":3,"title":"7.2 创建检查约束","slug":"_7-2-创建检查约束","link":"#_7-2-创建检查约束","children":[]},{"level":3,"title":"7.3 删除检查约束","slug":"_7-3-删除检查约束","link":"#_7-3-删除检查约束","children":[]},{"level":3,"title":"7.4 常用检查约束示例","slug":"_7-4-常用检查约束示例","link":"#_7-4-常用检查约束示例","children":[]}]},{"level":2,"title":"八、综合应用案例","slug":"八、综合应用案例","link":"#八、综合应用案例","children":[{"level":3,"title":"案例1：完整的用户表","slug":"案例1-完整的用户表","link":"#案例1-完整的用户表","children":[]},{"level":3,"title":"案例2：订单和订单详情（外键）","slug":"案例2-订单和订单详情-外键","link":"#案例2-订单和订单详情-外键","children":[]},{"level":3,"title":"案例3：学生选课系统","slug":"案例3-学生选课系统","link":"#案例3-学生选课系统","children":[]}]},{"level":2,"title":"九、本章总结","slug":"九、本章总结","link":"#九、本章总结","children":[{"level":3,"title":"核心要点","slug":"核心要点","link":"#核心要点","children":[]},{"level":3,"title":"约束使用建议","slug":"约束使用建议","link":"#约束使用建议","children":[]}]},{"level":2,"title":"练习题","slug":"练习题","link":"#练习题","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765251648000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/database/mysql/第02章-进阶篇/04-约束与数据完整性.md"}');export{v as comp,b as data};
