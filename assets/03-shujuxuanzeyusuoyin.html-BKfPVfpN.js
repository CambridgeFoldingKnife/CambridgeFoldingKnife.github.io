import{_ as t,c as e,d as c,e as s,f as a,b as l,w as o,r as i,o as u}from"./app-DyGs7pMe.js";const k={};function r(d,n){const p=i("RouteLink");return u(),e("div",null,[n[3]||(n[3]=c(`<h1 id="æ•°æ®é€‰æ‹©ä¸ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é€‰æ‹©ä¸ç´¢å¼•"><span>æ•°æ®é€‰æ‹©ä¸ç´¢å¼•</span></a></h1><blockquote><p>æŒæ¡Pandasçš„æ•°æ®é€‰æ‹©å’Œç´¢å¼•æŠ€å·§</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>æŒæ¡åˆ—é€‰æ‹©æ–¹æ³•</li><li>ç†è§£locå’Œilocçš„åŒºåˆ«</li><li>æŒæ¡å¸ƒå°”ç´¢å¼•</li><li>å­¦ä¼šä½¿ç”¨queryæ–¹æ³•</li><li>ç†è§£å¤šå±‚ç´¢å¼•</li></ul><h2 id="_1-åˆ—é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#_1-åˆ—é€‰æ‹©"><span>1. åˆ—é€‰æ‹©</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Alice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Bob&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Charlie&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;age&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;city&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;NY&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Paris&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;London&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;salary&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">,</span> <span class="token number">70000</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å•åˆ—é€‰æ‹©ï¼ˆè¿”å›Seriesï¼‰</span></span>
<span class="line">name_col <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>name_col<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Series</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å±æ€§è®¿é—®</span></span>
<span class="line">age_col <span class="token operator">=</span> df<span class="token punctuation">.</span>age</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤šåˆ—é€‰æ‹©ï¼ˆè¿”å›DataFrameï¼‰</span></span>
<span class="line">subset <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>subset<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># DataFrame</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©æ‰€æœ‰åˆ—é™¤äº†æŸäº›åˆ—</span></span>
<span class="line">cols <span class="token operator">=</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;city&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">subset <span class="token operator">=</span> df<span class="token punctuation">[</span>cols<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-è¡Œé€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#_2-è¡Œé€‰æ‹©"><span>2. è¡Œé€‰æ‹©</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># åˆ‡ç‰‡é€‰æ‹©</span></span>
<span class="line">first_two <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>first_two<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¡ä»¶é€‰æ‹©</span></span>
<span class="line">young <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>young<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤šæ¡ä»¶</span></span>
<span class="line">high_salary <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;salary&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">55000</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>high_salary<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-loc-æ ‡ç­¾ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_3-loc-æ ‡ç­¾ç´¢å¼•"><span>3. loc - æ ‡ç­¾ç´¢å¼•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;B&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;C&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;row2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;row3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;row4&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©å•è¡Œ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©å¤šè¡Œ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;row3&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©è¡Œå’Œåˆ—</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;row3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©æ‰€æœ‰è¡Œï¼Œéƒ¨åˆ†åˆ—</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¡ä»¶é€‰æ‹©</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># èµ‹å€¼</span></span>
<span class="line">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-iloc-ä½ç½®ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_4-iloc-ä½ç½®ç´¢å¼•"><span>4. iloc - ä½ç½®ç´¢å¼•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># é€‰æ‹©å•è¡Œ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©å¤šè¡Œ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ‡ç‰‡</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©è¡Œå’Œåˆ—</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># ç¬¬1è¡Œç¬¬1åˆ—</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># å‰2è¡Œå‰2åˆ—</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©æ‰€æœ‰è¡Œï¼Œéƒ¨åˆ†åˆ—</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è´Ÿç´¢å¼•</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># æœ€åä¸€è¡Œ</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-at-å’Œ-iat-å¿«é€Ÿæ ‡é‡è®¿é—®" tabindex="-1"><a class="header-anchor" href="#_5-at-å’Œ-iat-å¿«é€Ÿæ ‡é‡è®¿é—®"><span>5. at å’Œ iat - å¿«é€Ÿæ ‡é‡è®¿é—®</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># at - æ ‡ç­¾è®¿é—®ï¼ˆæ›´å¿«ï¼‰</span></span>
<span class="line">value <span class="token operator">=</span> df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># iat - ä½ç½®è®¿é—®ï¼ˆæ›´å¿«ï¼‰</span></span>
<span class="line">value <span class="token operator">=</span> df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># èµ‹å€¼</span></span>
<span class="line">df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token string">&#39;row1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">999</span></span>
<span class="line">df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">888</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-å¸ƒå°”ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_6-å¸ƒå°”ç´¢å¼•"><span>6. å¸ƒå°”ç´¢å¼•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Alice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Bob&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Charlie&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;David&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;age&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;salary&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">,</span> <span class="token number">70000</span><span class="token punctuation">,</span> <span class="token number">80000</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å•æ¡ä»¶</span></span>
<span class="line">young <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">35</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤šæ¡ä»¶ï¼ˆä¸ï¼‰</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;salary&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">55000</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤šæ¡ä»¶ï¼ˆæˆ–ï¼‰</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;salary&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">70000</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å–å</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># isin æ–¹æ³•</span></span>
<span class="line">names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;Alice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Charlie&#39;</span><span class="token punctuation">]</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å­—ç¬¦ä¸²æ–¹æ³•</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-query-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7-query-æ–¹æ³•"><span>7. query æ–¹æ³•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># ç®€æ´çš„æŸ¥è¯¢è¯­æ³•</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;age &gt; 30&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤šæ¡ä»¶</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;age &gt; 25 and salary &gt; 55000&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨å˜é‡</span></span>
<span class="line">min_age <span class="token operator">=</span> <span class="token number">30</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;age &gt; @min_age&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å­—ç¬¦ä¸²åŒ¹é…</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;name == &quot;Alice&quot;&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># in æ“ä½œ</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;age in [25, 35]&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8-å¤šå±‚ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_8-å¤šå±‚ç´¢å¼•"><span>8. å¤šå±‚ç´¢å¼•</span></a></h2><h3 id="_8-1-åˆ›å»ºå¤šå±‚ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_8-1-åˆ›å»ºå¤šå±‚ç´¢å¼•"><span>8.1 åˆ›å»ºå¤šå±‚ç´¢å¼•</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># ä»å…ƒç»„åˆ›å»º</span></span>
<span class="line">index <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_tuples<span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;letter&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;number&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;value&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span>index<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-2-å¤šå±‚ç´¢å¼•é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#_8-2-å¤šå±‚ç´¢å¼•é€‰æ‹©"><span>8.2 å¤šå±‚ç´¢å¼•é€‰æ‹©</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># é€‰æ‹©ç¬¬ä¸€å±‚</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©å¤šå±‚</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨slice</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># xs æ–¹æ³•</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>xs<span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> level<span class="token operator">=</span><span class="token string">&#39;letter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>xs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> level<span class="token operator">=</span><span class="token string">&#39;number&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-3-å¤šå±‚ç´¢å¼•æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_8-3-å¤šå±‚ç´¢å¼•æ“ä½œ"><span>8.3 å¤šå±‚ç´¢å¼•æ“ä½œ</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># é‡ç½®ç´¢å¼•</span></span>
<span class="line">df_reset <span class="token operator">=</span> df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¾ç½®ç´¢å¼•</span></span>
<span class="line">df_indexed <span class="token operator">=</span> df_reset<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;letter&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;number&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># äº¤æ¢å±‚çº§</span></span>
<span class="line">df_swapped <span class="token operator">=</span> df<span class="token punctuation">.</span>swaplevel<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ’åº</span></span>
<span class="line">df_sorted <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-å®æˆ˜ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#_9-å®æˆ˜ç¤ºä¾‹"><span>9. å®æˆ˜ç¤ºä¾‹</span></a></h2><h3 id="ç¤ºä¾‹1-æ•°æ®ç­›é€‰" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹1-æ•°æ®ç­›é€‰"><span>ç¤ºä¾‹1ï¼šæ•°æ®ç­›é€‰</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># å­¦ç”Ÿæˆç»©æ•°æ®</span></span>
<span class="line">scores <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Alice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Bob&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Charlie&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;David&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Eve&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;math&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;english&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;science&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰¾å‡ºæ•°å­¦æˆç»©å¤§äº90çš„å­¦ç”Ÿ</span></span>
<span class="line">high_math <span class="token operator">=</span> scores<span class="token punctuation">[</span>scores<span class="token punctuation">[</span><span class="token string">&#39;math&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">90</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;æ•°å­¦æˆç»©&gt;90:\\n&#39;</span><span class="token punctuation">,</span> high_math<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰¾å‡ºæ•°å­¦å’Œè‹±è¯­éƒ½å¤§äº85çš„å­¦ç”Ÿ</span></span>
<span class="line">good_students <span class="token operator">=</span> scores<span class="token punctuation">[</span><span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">&#39;math&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">85</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">&#39;english&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\\næ•°å­¦å’Œè‹±è¯­éƒ½&gt;85:\\n&#39;</span><span class="token punctuation">,</span> good_students<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰¾å‡ºä»»ä¸€ç§‘ç›®å¤§äº90çš„å­¦ç”Ÿ</span></span>
<span class="line">excellent <span class="token operator">=</span> scores<span class="token punctuation">[</span><span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">&#39;math&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">|</span> </span>
<span class="line">                   <span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">&#39;english&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">|</span> </span>
<span class="line">                   <span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">&#39;science&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\\nä»»ä¸€ç§‘ç›®&gt;90:\\n&#39;</span><span class="token punctuation">,</span> excellent<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹2-æ¡ä»¶èµ‹å€¼" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹2-æ¡ä»¶èµ‹å€¼"><span>ç¤ºä¾‹2ï¼šæ¡ä»¶èµ‹å€¼</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># æ ¹æ®æ¡ä»¶ä¿®æ”¹æ•°æ®</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;score&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†å¤§äº90çš„åˆ†æ•°è®¾ä¸ºä¼˜ç§€</span></span>
<span class="line">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;score&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token string">&#39;grade&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;A&#39;</span></span>
<span class="line">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;score&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;score&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;grade&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;B&#39;</span></span>
<span class="line">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;score&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">&#39;grade&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;C&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹3-å¤æ‚ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹3-å¤æ‚ç´¢å¼•"><span>ç¤ºä¾‹3ï¼šå¤æ‚ç´¢å¼•</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># é”€å”®æ•°æ®</span></span>
<span class="line">sales <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;date&#39;</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">&#39;2024-01-01&#39;</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;product&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;quantity&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;price&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¾ç½®å¤šå±‚ç´¢å¼•</span></span>
<span class="line">sales_indexed <span class="token operator">=</span> sales<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;product&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥è¯¢ç‰¹å®šæ—¥æœŸçš„äº§å“A</span></span>
<span class="line">result <span class="token operator">=</span> sales_indexed<span class="token punctuation">.</span>xs<span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> level<span class="token operator">=</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥è¯¢ç‰¹å®šæ—¥æœŸèŒƒå›´</span></span>
<span class="line">result <span class="token operator">=</span> sales_indexed<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;2024-01-01&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;2024-01-05&#39;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_10-æ€§èƒ½æŠ€å·§" tabindex="-1"><a class="header-anchor" href="#_10-æ€§èƒ½æŠ€å·§"><span>10. æ€§èƒ½æŠ€å·§</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> time</span>
<span class="line"></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;B&#39;</span><span class="token punctuation">:</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨locï¼ˆæ¨èï¼‰</span></span>
<span class="line">start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">50000</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;locè€—æ—¶: </span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string">ç§’&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨å¸ƒå°”ç´¢å¼•ï¼ˆå¿«ï¼‰</span></span>
<span class="line">start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">50000</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;å¸ƒå°”ç´¢å¼•è€—æ—¶: </span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string">ç§’&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨queryï¼ˆæ›´å¿«ï¼‰</span></span>
<span class="line">start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">result <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;A &gt; 50000&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;queryè€—æ—¶: </span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string">ç§’&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç»ƒä¹ é¢˜" tabindex="-1"><a class="header-anchor" href="#ç»ƒä¹ é¢˜"><span>ç»ƒä¹ é¢˜</span></a></h2><ol><li>é€‰æ‹©DataFrameçš„ç¬¬2åˆ°ç¬¬5è¡Œ</li><li>é€‰æ‹©å¹´é¾„å¤§äº30ä¸”å·¥èµ„å¤§äº60000çš„å‘˜å·¥</li><li>ä½¿ç”¨queryæ–¹æ³•ç­›é€‰æ•°æ®</li><li>åˆ›å»ºå¤šå±‚ç´¢å¼•å¹¶è¿›è¡Œé€‰æ‹©</li></ol><hr>`,37)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),l(p,{to:"/tutorials/python-ai/pandas/04-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97.html"},{default:o(()=>[...n[0]||(n[0]=[a("æ•°æ®æ¸…æ´—",-1)])]),_:1})])])}const v=t(k,[["render",r]]),b=JSON.parse('{"path":"/tutorials/python-ai/pandas/03-shujuxuanzeyusuoyin.html","title":"æ•°æ®é€‰æ‹©ä¸ç´¢å¼•","lang":"zh-CN","frontmatter":{"title":"æ•°æ®é€‰æ‹©ä¸ç´¢å¼•"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. åˆ—é€‰æ‹©","slug":"_1-åˆ—é€‰æ‹©","link":"#_1-åˆ—é€‰æ‹©","children":[]},{"level":2,"title":"2. è¡Œé€‰æ‹©","slug":"_2-è¡Œé€‰æ‹©","link":"#_2-è¡Œé€‰æ‹©","children":[]},{"level":2,"title":"3. loc - æ ‡ç­¾ç´¢å¼•","slug":"_3-loc-æ ‡ç­¾ç´¢å¼•","link":"#_3-loc-æ ‡ç­¾ç´¢å¼•","children":[]},{"level":2,"title":"4. iloc - ä½ç½®ç´¢å¼•","slug":"_4-iloc-ä½ç½®ç´¢å¼•","link":"#_4-iloc-ä½ç½®ç´¢å¼•","children":[]},{"level":2,"title":"5. at å’Œ iat - å¿«é€Ÿæ ‡é‡è®¿é—®","slug":"_5-at-å’Œ-iat-å¿«é€Ÿæ ‡é‡è®¿é—®","link":"#_5-at-å’Œ-iat-å¿«é€Ÿæ ‡é‡è®¿é—®","children":[]},{"level":2,"title":"6. å¸ƒå°”ç´¢å¼•","slug":"_6-å¸ƒå°”ç´¢å¼•","link":"#_6-å¸ƒå°”ç´¢å¼•","children":[]},{"level":2,"title":"7. query æ–¹æ³•","slug":"_7-query-æ–¹æ³•","link":"#_7-query-æ–¹æ³•","children":[]},{"level":2,"title":"8. å¤šå±‚ç´¢å¼•","slug":"_8-å¤šå±‚ç´¢å¼•","link":"#_8-å¤šå±‚ç´¢å¼•","children":[{"level":3,"title":"8.1 åˆ›å»ºå¤šå±‚ç´¢å¼•","slug":"_8-1-åˆ›å»ºå¤šå±‚ç´¢å¼•","link":"#_8-1-åˆ›å»ºå¤šå±‚ç´¢å¼•","children":[]},{"level":3,"title":"8.2 å¤šå±‚ç´¢å¼•é€‰æ‹©","slug":"_8-2-å¤šå±‚ç´¢å¼•é€‰æ‹©","link":"#_8-2-å¤šå±‚ç´¢å¼•é€‰æ‹©","children":[]},{"level":3,"title":"8.3 å¤šå±‚ç´¢å¼•æ“ä½œ","slug":"_8-3-å¤šå±‚ç´¢å¼•æ“ä½œ","link":"#_8-3-å¤šå±‚ç´¢å¼•æ“ä½œ","children":[]}]},{"level":2,"title":"9. å®æˆ˜ç¤ºä¾‹","slug":"_9-å®æˆ˜ç¤ºä¾‹","link":"#_9-å®æˆ˜ç¤ºä¾‹","children":[{"level":3,"title":"ç¤ºä¾‹1ï¼šæ•°æ®ç­›é€‰","slug":"ç¤ºä¾‹1-æ•°æ®ç­›é€‰","link":"#ç¤ºä¾‹1-æ•°æ®ç­›é€‰","children":[]},{"level":3,"title":"ç¤ºä¾‹2ï¼šæ¡ä»¶èµ‹å€¼","slug":"ç¤ºä¾‹2-æ¡ä»¶èµ‹å€¼","link":"#ç¤ºä¾‹2-æ¡ä»¶èµ‹å€¼","children":[]},{"level":3,"title":"ç¤ºä¾‹3ï¼šå¤æ‚ç´¢å¼•","slug":"ç¤ºä¾‹3-å¤æ‚ç´¢å¼•","link":"#ç¤ºä¾‹3-å¤æ‚ç´¢å¼•","children":[]}]},{"level":2,"title":"10. æ€§èƒ½æŠ€å·§","slug":"_10-æ€§èƒ½æŠ€å·§","link":"#_10-æ€§èƒ½æŠ€å·§","children":[]},{"level":2,"title":"ç»ƒä¹ é¢˜","slug":"ç»ƒä¹ é¢˜","link":"#ç»ƒä¹ é¢˜","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/pandas/03-æ•°æ®é€‰æ‹©ä¸ç´¢å¼•.md"}');export{v as comp,b as data};
