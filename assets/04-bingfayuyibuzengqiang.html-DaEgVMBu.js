import{_ as o,c,d as i,e as s,f as a,b as p,w as u,r as t,o as r}from"./app-D9dfRPMK.js";const k={},d={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-taskpool-0000001820880665-V5",target:"_blank",rel:"noopener noreferrer"},v={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-worker-0000001821000441-V5",target:"_blank",rel:"noopener noreferrer"};function m(b,n){const e=t("ExternalLinkIcon"),l=t("RouteLink");return r(),c("div",null,[n[5]||(n[5]=i(`<h1 id="å¹¶å‘ä¸å¼‚æ­¥å¢å¼º" tabindex="-1"><a class="header-anchor" href="#å¹¶å‘ä¸å¼‚æ­¥å¢å¼º"><span>å¹¶å‘ä¸å¼‚æ­¥å¢å¼º</span></a></h1><blockquote><p>æŒæ¡ HarmonyOS NEXT çš„å¹¶å‘ç¼–ç¨‹</p></blockquote><h2 id="ğŸ”„-promise-ä¸-async-await" tabindex="-1"><a class="header-anchor" href="#ğŸ”„-promise-ä¸-async-await"><span>ğŸ”„ Promise ä¸ async/await</span></a></h2><h3 id="åŸºç¡€ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€ç”¨æ³•"><span>åŸºç¡€ç”¨æ³•</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// Promise åŸºç¡€</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;æ•°æ®åŠ è½½å®Œæˆ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// async/await</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;åŠ è½½å¤±è´¥:&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¹¶è¡Œæ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#å¹¶è¡Œæ‰§è¡Œ"><span>å¹¶è¡Œæ‰§è¡Œ</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå¼‚æ­¥æ“ä½œ</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>user<span class="token punctuation">,</span> orders<span class="token punctuation">,</span> products<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">    <span class="token function">fetchUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">fetchOrders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">fetchProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span> user<span class="token punctuation">,</span> orders<span class="token punctuation">,</span> products <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Promise.race - å–æœ€å¿«çš„</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">quickFetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">    <span class="token function">fetchFromCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">fetchFromNetwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> result</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="âš¡-taskpool-ä»»åŠ¡æ± " tabindex="-1"><a class="header-anchor" href="#âš¡-taskpool-ä»»åŠ¡æ± "><span>âš¡ TaskPool ä»»åŠ¡æ± </span></a></h2><h3 id="åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨"><span>åŸºæœ¬ä½¿ç”¨</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> taskpool <span class="token keyword">from</span> <span class="token string">&#39;@ohos.taskpool&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// å®šä¹‰å¹¶å‘ä»»åŠ¡</span></span>
<span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Concurrent</span></span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">heavyComputation</span><span class="token punctuation">(</span>numbers<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> numbers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sum <span class="token operator">+</span> num<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// æ‰§è¡Œä»»åŠ¡</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length<span class="token operator">:</span> <span class="token number">10000</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>_<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> i<span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">taskpool</span><span class="token punctuation">.</span><span class="token function">Task</span><span class="token punctuation">(</span>heavyComputation<span class="token punctuation">,</span> data<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> taskpool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;è®¡ç®—ç»“æœ:&#39;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä»»åŠ¡ç»„" tabindex="-1"><a class="header-anchor" href="#ä»»åŠ¡ç»„"><span>ä»»åŠ¡ç»„</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// æ‰¹é‡æ‰§è¡Œä»»åŠ¡</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">batchProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">taskpool</span><span class="token punctuation">.</span><span class="token function">Task</span><span class="token punctuation">(</span>processImage<span class="token punctuation">,</span> image1<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">taskpool</span><span class="token punctuation">.</span><span class="token function">Task</span><span class="token punctuation">(</span>processImage<span class="token punctuation">,</span> image2<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">taskpool</span><span class="token punctuation">.</span><span class="token function">Task</span><span class="token punctuation">(</span>processImage<span class="token punctuation">,</span> image3<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">const</span> group <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">taskpool</span><span class="token punctuation">.</span><span class="token function">TaskGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  tasks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>task <span class="token operator">=&gt;</span> group<span class="token punctuation">.</span><span class="token function">addTask</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> group<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;å¤„ç†å®Œæˆ:&#39;</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ‘·-worker-å¹¶å‘" tabindex="-1"><a class="header-anchor" href="#ğŸ‘·-worker-å¹¶å‘"><span>ğŸ‘· Worker å¹¶å‘</span></a></h2><h3 id="åˆ›å»º-worker" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-worker"><span>åˆ›å»º Worker</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// ä¸»çº¿ç¨‹</span></span>
<span class="line"><span class="token keyword">import</span> worker <span class="token keyword">from</span> <span class="token string">&#39;@ohos.worker&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> workerInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">worker</span><span class="token punctuation">.</span><span class="token function">ThreadWorker</span><span class="token punctuation">(</span><span class="token string">&#39;entry/ets/workers/MyWorker.ets&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// å‘é€æ¶ˆæ¯</span></span>
<span class="line">workerInstance<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;start&#39;</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// æ¥æ”¶æ¶ˆæ¯</span></span>
<span class="line">workerInstance<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Worker è¿”å›:&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Worker çº¿ç¨‹ (MyWorker.ets)</span></span>
<span class="line"><span class="token keyword">import</span> worker <span class="token keyword">from</span> <span class="token string">&#39;@ohos.worker&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> parentPort <span class="token operator">=</span> worker<span class="token punctuation">.</span>workerPort</span>
<span class="line"></span>
<span class="line">parentPort<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> type<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>data</span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;start&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></span>
<span class="line">    parentPort<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> result <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> data<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sum <span class="token operator">+</span> num<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ’¡-æœ€ä½³å®è·µ" tabindex="-1"><a class="header-anchor" href="#ğŸ’¡-æœ€ä½³å®è·µ"><span>ğŸ’¡ æœ€ä½³å®è·µ</span></a></h2><h3 id="_1-é€‰æ‹©åˆé€‚çš„å¹¶å‘æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_1-é€‰æ‹©åˆé€‚çš„å¹¶å‘æ–¹å¼"><span>1. é€‰æ‹©åˆé€‚çš„å¹¶å‘æ–¹å¼</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// TaskPool - çŸ­æ—¶ä»»åŠ¡</span></span>
<span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Concurrent</span></span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">quickTask</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> data <span class="token operator">*</span> <span class="token number">2</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Worker - é•¿æ—¶ä»»åŠ¡</span></span>
<span class="line"><span class="token comment">// åœ¨ Worker.ets ä¸­å¤„ç†è€—æ—¶æ“ä½œ</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-é”™è¯¯å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_2-é”™è¯¯å¤„ç†"><span>2. é”™è¯¯å¤„ç†</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">safeExecute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">taskpool</span><span class="token punctuation">.</span><span class="token function">Task</span><span class="token punctuation">(</span>compute<span class="token punctuation">,</span> data<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> taskpool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> result</span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;ä»»åŠ¡æ‰§è¡Œå¤±è´¥:&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">null</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-é¿å…é˜»å¡ä¸»çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-é¿å…é˜»å¡ä¸»çº¿ç¨‹"><span>3. é¿å…é˜»å¡ä¸»çº¿ç¨‹</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// âœ… è€—æ—¶æ“ä½œæ”¾åˆ°åå°</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">processLargeData</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">taskpool</span><span class="token punctuation">.</span><span class="token function">Task</span><span class="token punctuation">(</span>heavyProcess<span class="token punctuation">,</span> data<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token keyword">await</span> taskpool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// âŒ é¿å…åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">badProcess</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// é˜»å¡ä¸»çº¿ç¨‹</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“š-å‚è€ƒèµ„æº" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å‚è€ƒèµ„æº"><span>ğŸ“š å‚è€ƒèµ„æº</span></a></h2>`,23)),s("ul",null,[s("li",null,[s("a",d,[n[0]||(n[0]=a("TaskPool ä»»åŠ¡æ± ",-1)),p(e)])]),s("li",null,[s("a",v,[n[1]||(n[1]=a("Worker å·¥ä½œçº¿ç¨‹",-1)),p(e)])])]),n[6]||(n[6]=s("hr",null,null,-1)),s("p",null,[n[3]||(n[3]=s("strong",null,"ä¸‹ä¸€èŠ‚",-1)),n[4]||(n[4]=a(" â†’ ",-1)),p(l,{to:"/tutorials/harmonyos-dev/02-arkts-advanced/05-%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html"},{default:u(()=>[...n[2]||(n[2]=[a("ç±»å‹å®‰å…¨æœ€ä½³å®è·µ",-1)])]),_:1})])])}const y=o(k,[["render",m]]),w=JSON.parse('{"path":"/tutorials/harmonyos-dev/02-arkts-advanced/04-bingfayuyibuzengqiang.html","title":"å¹¶å‘ä¸å¼‚æ­¥å¢å¼º","lang":"zh-CN","frontmatter":{"title":"å¹¶å‘ä¸å¼‚æ­¥å¢å¼º","date":"2025-01-22T00:00:00.000Z"},"headers":[{"level":2,"title":"ğŸ”„ Promise ä¸ async/await","slug":"ğŸ”„-promise-ä¸-async-await","link":"#ğŸ”„-promise-ä¸-async-await","children":[{"level":3,"title":"åŸºç¡€ç”¨æ³•","slug":"åŸºç¡€ç”¨æ³•","link":"#åŸºç¡€ç”¨æ³•","children":[]},{"level":3,"title":"å¹¶è¡Œæ‰§è¡Œ","slug":"å¹¶è¡Œæ‰§è¡Œ","link":"#å¹¶è¡Œæ‰§è¡Œ","children":[]}]},{"level":2,"title":"âš¡ TaskPool ä»»åŠ¡æ± ","slug":"âš¡-taskpool-ä»»åŠ¡æ± ","link":"#âš¡-taskpool-ä»»åŠ¡æ± ","children":[{"level":3,"title":"åŸºæœ¬ä½¿ç”¨","slug":"åŸºæœ¬ä½¿ç”¨","link":"#åŸºæœ¬ä½¿ç”¨","children":[]},{"level":3,"title":"ä»»åŠ¡ç»„","slug":"ä»»åŠ¡ç»„","link":"#ä»»åŠ¡ç»„","children":[]}]},{"level":2,"title":"ğŸ‘· Worker å¹¶å‘","slug":"ğŸ‘·-worker-å¹¶å‘","link":"#ğŸ‘·-worker-å¹¶å‘","children":[{"level":3,"title":"åˆ›å»º Worker","slug":"åˆ›å»º-worker","link":"#åˆ›å»º-worker","children":[]}]},{"level":2,"title":"ğŸ’¡ æœ€ä½³å®è·µ","slug":"ğŸ’¡-æœ€ä½³å®è·µ","link":"#ğŸ’¡-æœ€ä½³å®è·µ","children":[{"level":3,"title":"1. é€‰æ‹©åˆé€‚çš„å¹¶å‘æ–¹å¼","slug":"_1-é€‰æ‹©åˆé€‚çš„å¹¶å‘æ–¹å¼","link":"#_1-é€‰æ‹©åˆé€‚çš„å¹¶å‘æ–¹å¼","children":[]},{"level":3,"title":"2. é”™è¯¯å¤„ç†","slug":"_2-é”™è¯¯å¤„ç†","link":"#_2-é”™è¯¯å¤„ç†","children":[]},{"level":3,"title":"3. é¿å…é˜»å¡ä¸»çº¿ç¨‹","slug":"_3-é¿å…é˜»å¡ä¸»çº¿ç¨‹","link":"#_3-é¿å…é˜»å¡ä¸»çº¿ç¨‹","children":[]}]},{"level":2,"title":"ğŸ“š å‚è€ƒèµ„æº","slug":"ğŸ“š-å‚è€ƒèµ„æº","link":"#ğŸ“š-å‚è€ƒèµ„æº","children":[]}],"git":{"createdTime":1765250065000,"updatedTime":1765250065000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/harmonyos-dev/02-arkts-advanced/04-å¹¶å‘ä¸å¼‚æ­¥å¢å¼º.md"}');export{y as comp,w as data};
