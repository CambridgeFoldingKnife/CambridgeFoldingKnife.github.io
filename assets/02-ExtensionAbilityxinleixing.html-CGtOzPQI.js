import{_ as i,c,d as o,e as s,f as a,b as p,w as u,r as t,o as r}from"./app-DyGs7pMe.js";const k={},d={href:"https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/extensionability-overview-0000001478341009-V3",target:"_blank",rel:"noopener noreferrer"};function v(m,n){const e=t("ExternalLinkIcon"),l=t("RouteLink");return r(),c("div",null,[n[4]||(n[4]=o(`<h1 id="extensionability-æ–°ç±»å‹" tabindex="-1"><a class="header-anchor" href="#extensionability-æ–°ç±»å‹"><span>ExtensionAbility æ–°ç±»å‹</span></a></h1><blockquote><p>æ‰©å±•åº”ç”¨èƒ½åŠ›çš„ç»„ä»¶</p></blockquote><h2 id="ğŸ¯-extensionability-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#ğŸ¯-extensionability-æ¦‚è¿°"><span>ğŸ¯ ExtensionAbility æ¦‚è¿°</span></a></h2><p>ExtensionAbility æ˜¯ä¸€ç§ç‰¹æ®Šçš„ Abilityï¼Œç”¨äºæ‰©å±•åº”ç”¨çš„ç‰¹å®šåŠŸèƒ½ï¼Œé€šå¸¸æ²¡æœ‰ç”¨æˆ·ç•Œé¢ã€‚</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">ExtensionAbility ç±»å‹</span>
<span class="line">â”œâ”€ FormExtensionAbilityï¼ˆæœåŠ¡å¡ç‰‡ï¼‰</span>
<span class="line">â”œâ”€ ServiceExtensionAbilityï¼ˆåå°æœåŠ¡ï¼‰</span>
<span class="line">â”œâ”€ DataShareExtensionAbilityï¼ˆæ•°æ®å…±äº«ï¼‰</span>
<span class="line">â”œâ”€ StaticSubscriberExtensionAbilityï¼ˆé™æ€è®¢é˜…ï¼‰</span>
<span class="line">â””â”€ WindowExtensionAbilityï¼ˆçª—å£æ‰©å±•ï¼‰</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“‡-formextensionability" tabindex="-1"><a class="header-anchor" href="#ğŸ“‡-formextensionability"><span>ğŸ“‡ FormExtensionAbility</span></a></h2><h3 id="æœåŠ¡å¡ç‰‡" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡å¡ç‰‡"><span>æœåŠ¡å¡ç‰‡</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> FormExtensionAbility <span class="token keyword">from</span> <span class="token string">&#39;@ohos.app.form.FormExtensionAbility&#39;</span></span>
<span class="line"><span class="token keyword">import</span> formBindingData <span class="token keyword">from</span> <span class="token string">&#39;@ohos.app.form.formBindingData&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">WeatherFormAbility</span> <span class="token keyword">extends</span> <span class="token class-name">FormExtensionAbility</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// åˆ›å»ºå¡ç‰‡</span></span>
<span class="line">  <span class="token function">onAddForm</span><span class="token punctuation">(</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;åˆ›å»ºå¡ç‰‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      temperature<span class="token operator">:</span> <span class="token string">&#39;25Â°C&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      weather<span class="token operator">:</span> <span class="token string">&#39;æ™´å¤©&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      city<span class="token operator">:</span> <span class="token string">&#39;åŒ—äº¬&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> formBindingData<span class="token punctuation">.</span><span class="token function">createFormBindingData</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// æ›´æ–°å¡ç‰‡</span></span>
<span class="line">  <span class="token function">onUpdateForm</span><span class="token punctuation">(</span>formId<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ›´æ–°å¡ç‰‡:&#39;</span><span class="token punctuation">,</span> formId<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      temperature<span class="token operator">:</span> <span class="token string">&#39;26Â°C&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      weather<span class="token operator">:</span> <span class="token string">&#39;å¤šäº‘&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      city<span class="token operator">:</span> <span class="token string">&#39;åŒ—äº¬&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> formBindingData<span class="token punctuation">.</span><span class="token function">createFormBindingData</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// åˆ é™¤å¡ç‰‡</span></span>
<span class="line">  <span class="token function">onRemoveForm</span><span class="token punctuation">(</span>formId<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;åˆ é™¤å¡ç‰‡:&#39;</span><span class="token punctuation">,</span> formId<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// å¡ç‰‡å¯è§æ€§å˜åŒ–</span></span>
<span class="line">  <span class="token function">onVisibilityChange</span><span class="token punctuation">(</span>formIds<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;å¡ç‰‡å¯è§æ€§å˜åŒ–:&#39;</span><span class="token punctuation">,</span> formIds<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¡ç‰‡é¡µé¢" tabindex="-1"><a class="header-anchor" href="#å¡ç‰‡é¡µé¢"><span>å¡ç‰‡é¡µé¢</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entry</span></span></span>
<span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span></span>
<span class="line">struct WeatherCard <span class="token punctuation">{</span></span>
<span class="line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">LocalStorageProp</span></span><span class="token punctuation">(</span><span class="token string">&#39;temperature&#39;</span><span class="token punctuation">)</span> temperature<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&#39;--&#39;</span></span>
<span class="line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">LocalStorageProp</span></span><span class="token punctuation">(</span><span class="token string">&#39;weather&#39;</span><span class="token punctuation">)</span> weather<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&#39;--&#39;</span></span>
<span class="line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">LocalStorageProp</span></span><span class="token punctuation">(</span><span class="token string">&#39;city&#39;</span><span class="token punctuation">)</span> city<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&#39;--&#39;</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">Text</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>city<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">fontSize</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">fontWeight</span><span class="token punctuation">(</span>FontWeight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span></span>
<span class="line">      </span>
<span class="line">      <span class="token function">Text</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>temperature<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">fontSize</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">fontColor</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Blue<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">margin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> top<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      </span>
<span class="line">      <span class="token function">Text</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>weather<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">fontSize</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">fontColor</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Gray<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">margin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> top<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token string">&#39;100%&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token string">&#39;100%&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">justifyContent</span><span class="token punctuation">(</span>FlexAlign<span class="token punctuation">.</span>Center<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">backgroundColor</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>White<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">borderRadius</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®šæ—¶æ›´æ–°å¡ç‰‡" tabindex="-1"><a class="header-anchor" href="#å®šæ—¶æ›´æ–°å¡ç‰‡"><span>å®šæ—¶æ›´æ–°å¡ç‰‡</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> formProvider <span class="token keyword">from</span> <span class="token string">&#39;@ohos.app.form.formProvider&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">WeatherFormAbility</span> <span class="token keyword">extends</span> <span class="token class-name">FormExtensionAbility</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">private</span> timers<span class="token operator">:</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">onAddForm</span><span class="token punctuation">(</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> formId <span class="token operator">=</span> want<span class="token punctuation">.</span>parameters<span class="token punctuation">[</span><span class="token string">&#39;ohos.extra.param.key.form_identity&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// æ¯5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡</span></span>
<span class="line">    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateForm</span><span class="token punctuation">(</span>formId<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>timers<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>formId<span class="token punctuation">,</span> timer<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">async</span> <span class="token function">updateForm</span><span class="token punctuation">(</span>formId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchWeatherData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    formProvider<span class="token punctuation">.</span><span class="token function">updateForm</span><span class="token punctuation">(</span>formId<span class="token punctuation">,</span> formBindingData<span class="token punctuation">.</span><span class="token function">createFormBindingData</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ›´æ–°å¡ç‰‡æˆåŠŸ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;æ›´æ–°å¡ç‰‡å¤±è´¥:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">onRemoveForm</span><span class="token punctuation">(</span>formId<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// æ¸…ç†å®šæ—¶å™¨</span></span>
<span class="line">    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>timers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>formId<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span>timers<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>formId<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">async</span> <span class="token function">fetchWeatherData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// è·å–å¤©æ°”æ•°æ®</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      temperature<span class="token operator">:</span> <span class="token string">&#39;25Â°C&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      weather<span class="token operator">:</span> <span class="token string">&#39;æ™´å¤©&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      city<span class="token operator">:</span> <span class="token string">&#39;åŒ—äº¬&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ”§-serviceextensionability" tabindex="-1"><a class="header-anchor" href="#ğŸ”§-serviceextensionability"><span>ğŸ”§ ServiceExtensionAbility</span></a></h2><h3 id="åå°æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#åå°æœåŠ¡"><span>åå°æœåŠ¡</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> ServiceExtensionAbility <span class="token keyword">from</span> <span class="token string">&#39;@ohos.app.ability.ServiceExtensionAbility&#39;</span></span>
<span class="line"><span class="token keyword">import</span> Want <span class="token keyword">from</span> <span class="token string">&#39;@ohos.app.ability.Want&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">BackgroundService</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceExtensionAbility</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">onCreate</span><span class="token punctuation">(</span>want<span class="token operator">:</span> Want<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;åå°æœåŠ¡åˆ›å»º&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">onRequest</span><span class="token punctuation">(</span>want<span class="token operator">:</span> Want<span class="token punctuation">,</span> startId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æœåŠ¡è¯·æ±‚:&#39;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> startId<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// æ‰§è¡Œåå°ä»»åŠ¡</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">performBackgroundTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">onConnect</span><span class="token punctuation">(</span>want<span class="token operator">:</span> Want<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æœåŠ¡è¿æ¥&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">null</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">onDisconnect</span><span class="token punctuation">(</span>want<span class="token operator">:</span> Want<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æœåŠ¡æ–­å¼€&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æœåŠ¡é”€æ¯&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">async</span> <span class="token function">performBackgroundTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// æ‰§è¡Œè€—æ—¶ä»»åŠ¡</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ‰§è¡Œåå°ä»»åŠ¡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¯åŠ¨åå°æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#å¯åŠ¨åå°æœåŠ¡"><span>å¯åŠ¨åå°æœåŠ¡</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> common <span class="token keyword">from</span> <span class="token string">&#39;@ohos.app.ability.common&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entry</span></span></span>
<span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span></span>
<span class="line">struct Index <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">private</span> context <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token keyword">as</span> common<span class="token punctuation">.</span>UIAbilityContext</span>
<span class="line">  </span>
<span class="line">  <span class="token function">startBackgroundService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> want <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      bundleName<span class="token operator">:</span> <span class="token string">&#39;com.example.myapp&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      abilityName<span class="token operator">:</span> <span class="token string">&#39;BackgroundService&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">startServiceExtensionAbility</span><span class="token punctuation">(</span>want<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;å¯åŠ¨åå°æœåŠ¡æˆåŠŸ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;å¯åŠ¨å¤±è´¥:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">stopBackgroundService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> want <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      bundleName<span class="token operator">:</span> <span class="token string">&#39;com.example.myapp&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      abilityName<span class="token operator">:</span> <span class="token string">&#39;BackgroundService&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">stopServiceExtensionAbility</span><span class="token punctuation">(</span>want<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;åœæ­¢åå°æœåŠ¡æˆåŠŸ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span> space<span class="token operator">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">&#39;å¯åŠ¨æœåŠ¡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startBackgroundService</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      </span>
<span class="line">      <span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">&#39;åœæ­¢æœåŠ¡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopBackgroundService</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“Š-datashareextensionability" tabindex="-1"><a class="header-anchor" href="#ğŸ“Š-datashareextensionability"><span>ğŸ“Š DataShareExtensionAbility</span></a></h2><h3 id="æ•°æ®å…±äº«" tabindex="-1"><a class="header-anchor" href="#æ•°æ®å…±äº«"><span>æ•°æ®å…±äº«</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> DataShareExtensionAbility <span class="token keyword">from</span> <span class="token string">&#39;@ohos.application.DataShareExtensionAbility&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">DataShareExt</span> <span class="token keyword">extends</span> <span class="token class-name">DataShareExtensionAbility</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// æ’å…¥æ•°æ®</span></span>
<span class="line">  <span class="token function">insert</span><span class="token punctuation">(</span>uri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> ValuesBucket<span class="token punctuation">,</span> callback<span class="token operator">:</span> AsyncCallback<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ’å…¥æ•°æ®:&#39;</span><span class="token punctuation">,</span> uri<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// æ‰§è¡Œæ’å…¥æ“ä½œ</span></span>
<span class="line">    <span class="token keyword">const</span> rowId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>database<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> rowId<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// æŸ¥è¯¢æ•°æ®</span></span>
<span class="line">  <span class="token function">query</span><span class="token punctuation">(</span>uri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> predicates<span class="token operator">:</span> dataSharePredicates<span class="token punctuation">.</span>DataSharePredicates<span class="token punctuation">,</span> </span>
<span class="line">        columns<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> callback<span class="token operator">:</span> AsyncCallback<span class="token operator">&lt;</span>Object<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æŸ¥è¯¢æ•°æ®:&#39;</span><span class="token punctuation">,</span> uri<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// æ‰§è¡ŒæŸ¥è¯¢</span></span>
<span class="line">    <span class="token keyword">const</span> resultSet <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>database<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>predicates<span class="token punctuation">,</span> columns<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> resultSet<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// æ›´æ–°æ•°æ®</span></span>
<span class="line">  <span class="token function">update</span><span class="token punctuation">(</span>uri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> predicates<span class="token operator">:</span> dataSharePredicates<span class="token punctuation">.</span>DataSharePredicates<span class="token punctuation">,</span></span>
<span class="line">         value<span class="token operator">:</span> ValuesBucket<span class="token punctuation">,</span> callback<span class="token operator">:</span> AsyncCallback<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ›´æ–°æ•°æ®:&#39;</span><span class="token punctuation">,</span> uri<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">const</span> rowCount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>database<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>predicates<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> rowCount<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// åˆ é™¤æ•°æ®</span></span>
<span class="line">  <span class="token keyword">delete</span><span class="token punctuation">(</span>uri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> predicates<span class="token operator">:</span> dataSharePredicates<span class="token punctuation">.</span>DataSharePredicates<span class="token punctuation">,</span></span>
<span class="line">         callback<span class="token operator">:</span> AsyncCallback<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;åˆ é™¤æ•°æ®:&#39;</span><span class="token punctuation">,</span> uri<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">const</span> rowCount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>database<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>predicates<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> rowCount<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ’¡-æœ€ä½³å®è·µ" tabindex="-1"><a class="header-anchor" href="#ğŸ’¡-æœ€ä½³å®è·µ"><span>ğŸ’¡ æœ€ä½³å®è·µ</span></a></h2><h3 id="_1-å¡ç‰‡æ€§èƒ½ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_1-å¡ç‰‡æ€§èƒ½ä¼˜åŒ–"><span>1. å¡ç‰‡æ€§èƒ½ä¼˜åŒ–</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// âœ… é¿å…é¢‘ç¹æ›´æ–°</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token constant">UPDATE_INTERVAL</span> <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span>  <span class="token comment">// 5åˆ†é’Ÿ</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// âœ… ç¼“å­˜æ•°æ®</span></span>
<span class="line"><span class="token keyword">private</span> cachedData<span class="token operator">:</span> WeatherData <span class="token operator">=</span> <span class="token keyword">null</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">async</span> <span class="token function">getFormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cachedData <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isDataExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cachedData</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span>cachedData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchWeatherData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cachedData</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-åå°æœåŠ¡èµ„æºç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_2-åå°æœåŠ¡èµ„æºç®¡ç†"><span>2. åå°æœåŠ¡èµ„æºç®¡ç†</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// âœ… æ¸…ç†èµ„æº</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">closeConnections</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">releaseResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-æ•°æ®å…±äº«å®‰å…¨" tabindex="-1"><a class="header-anchor" href="#_3-æ•°æ®å…±äº«å®‰å…¨"><span>3. æ•°æ®å…±äº«å®‰å…¨</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// âœ… æƒé™æ£€æŸ¥</span></span>
<span class="line"><span class="token function">insert</span><span class="token punctuation">(</span>uri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> ValuesBucket<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;æ— æƒé™&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// æ‰§è¡Œæ’å…¥</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“š-å‚è€ƒèµ„æº" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å‚è€ƒèµ„æº"><span>ğŸ“š å‚è€ƒèµ„æº</span></a></h2>`,28)),s("ul",null,[s("li",null,[s("a",d,[n[0]||(n[0]=a("ExtensionAbility å®˜æ–¹æ–‡æ¡£",-1)),p(e)])])]),n[5]||(n[5]=s("hr",null,null,-1)),s("p",null,[n[2]||(n[2]=s("strong",null,"ä¸‹ä¸€èŠ‚",-1)),n[3]||(n[3]=a(" â†’ ",-1)),p(l,{to:"/tutorials/harmonyos-dev/05-ability-framework/03-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86.html"},{default:u(()=>[...n[1]||(n[1]=[a("ç”Ÿå‘½å‘¨æœŸç®¡ç†",-1)])]),_:1})])])}const h=i(k,[["render",v]]),y=JSON.parse('{"path":"/tutorials/harmonyos-dev/05-ability-framework/02-ExtensionAbilityxinleixing.html","title":"ExtensionAbility æ–°ç±»å‹","lang":"zh-CN","frontmatter":{"title":"ExtensionAbility æ–°ç±»å‹","date":"2025-01-22T00:00:00.000Z"},"headers":[{"level":2,"title":"ğŸ¯ ExtensionAbility æ¦‚è¿°","slug":"ğŸ¯-extensionability-æ¦‚è¿°","link":"#ğŸ¯-extensionability-æ¦‚è¿°","children":[]},{"level":2,"title":"ğŸ“‡ FormExtensionAbility","slug":"ğŸ“‡-formextensionability","link":"#ğŸ“‡-formextensionability","children":[{"level":3,"title":"æœåŠ¡å¡ç‰‡","slug":"æœåŠ¡å¡ç‰‡","link":"#æœåŠ¡å¡ç‰‡","children":[]},{"level":3,"title":"å¡ç‰‡é¡µé¢","slug":"å¡ç‰‡é¡µé¢","link":"#å¡ç‰‡é¡µé¢","children":[]},{"level":3,"title":"å®šæ—¶æ›´æ–°å¡ç‰‡","slug":"å®šæ—¶æ›´æ–°å¡ç‰‡","link":"#å®šæ—¶æ›´æ–°å¡ç‰‡","children":[]}]},{"level":2,"title":"ğŸ”§ ServiceExtensionAbility","slug":"ğŸ”§-serviceextensionability","link":"#ğŸ”§-serviceextensionability","children":[{"level":3,"title":"åå°æœåŠ¡","slug":"åå°æœåŠ¡","link":"#åå°æœåŠ¡","children":[]},{"level":3,"title":"å¯åŠ¨åå°æœåŠ¡","slug":"å¯åŠ¨åå°æœåŠ¡","link":"#å¯åŠ¨åå°æœåŠ¡","children":[]}]},{"level":2,"title":"ğŸ“Š DataShareExtensionAbility","slug":"ğŸ“Š-datashareextensionability","link":"#ğŸ“Š-datashareextensionability","children":[{"level":3,"title":"æ•°æ®å…±äº«","slug":"æ•°æ®å…±äº«","link":"#æ•°æ®å…±äº«","children":[]}]},{"level":2,"title":"ğŸ’¡ æœ€ä½³å®è·µ","slug":"ğŸ’¡-æœ€ä½³å®è·µ","link":"#ğŸ’¡-æœ€ä½³å®è·µ","children":[{"level":3,"title":"1. å¡ç‰‡æ€§èƒ½ä¼˜åŒ–","slug":"_1-å¡ç‰‡æ€§èƒ½ä¼˜åŒ–","link":"#_1-å¡ç‰‡æ€§èƒ½ä¼˜åŒ–","children":[]},{"level":3,"title":"2. åå°æœåŠ¡èµ„æºç®¡ç†","slug":"_2-åå°æœåŠ¡èµ„æºç®¡ç†","link":"#_2-åå°æœåŠ¡èµ„æºç®¡ç†","children":[]},{"level":3,"title":"3. æ•°æ®å…±äº«å®‰å…¨","slug":"_3-æ•°æ®å…±äº«å®‰å…¨","link":"#_3-æ•°æ®å…±äº«å®‰å…¨","children":[]}]},{"level":2,"title":"ğŸ“š å‚è€ƒèµ„æº","slug":"ğŸ“š-å‚è€ƒèµ„æº","link":"#ğŸ“š-å‚è€ƒèµ„æº","children":[]}],"git":{"createdTime":1765250065000,"updatedTime":1765250065000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/harmonyos-dev/05-ability-framework/02-ExtensionAbilityæ–°ç±»å‹.md"}');export{h as comp,y as data};
