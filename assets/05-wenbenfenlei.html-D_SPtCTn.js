import{_ as t,c as e,d as l,e as s,f as a,b as c,w as o,r as i,o as u}from"./app-D9dfRPMK.js";const r={};function k(d,n){const p=i("RouteLink");return u(),e("div",null,[n[3]||(n[3]=l(`<h1 id="æ–‡æœ¬åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#æ–‡æœ¬åˆ†ç±»"><span>æ–‡æœ¬åˆ†ç±»</span></a></h1><blockquote><p>æŒæ¡æ–‡æœ¬åˆ†ç±»ç®—æ³•å’Œåº”ç”¨</p></blockquote><h2 id="ğŸ“š-å­¦ä¹ ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å­¦ä¹ ç›®æ ‡"><span>ğŸ“š å­¦ä¹ ç›®æ ‡</span></a></h2><ul><li>æŒæ¡æœ´ç´ è´å¶æ–¯åˆ†ç±»</li><li>å­¦ä¼šSVMæ–‡æœ¬åˆ†ç±»</li><li>äº†è§£æ·±åº¦å­¦ä¹ åˆ†ç±»</li><li>æŒæ¡è¯„ä¼°æŒ‡æ ‡</li></ul><h2 id="_1-æœ´ç´ è´å¶æ–¯" tabindex="-1"><a class="header-anchor" href="#_1-æœ´ç´ è´å¶æ–¯"><span>1. æœ´ç´ è´å¶æ–¯</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> MultinomialNB</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">import</span> jieba</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡†å¤‡æ•°æ®</span></span>
<span class="line">texts <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&quot;è¿™éƒ¨ç”µå½±å¤ªå¥½çœ‹äº†&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;è¿™å®¶é¤å…å¾ˆä¸é”™&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;è¿™ä¸ªæ‰‹æœºå¾ˆåƒåœ¾&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;æœåŠ¡æ€åº¦å¤ªå·®äº†&quot;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line">labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 1-æ­£é¢, 0-è´Ÿé¢</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†è¯</span></span>
<span class="line">texts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39; &#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> text <span class="token keyword">in</span> texts<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç‰¹å¾æå–</span></span>
<span class="line">vectorizer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>texts<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ’åˆ†æ•°æ®é›†</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span></span>
<span class="line">    X<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">clf <span class="token operator">=</span> MultinomialNB<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹</span></span>
<span class="line">predictions <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‡†ç¡®ç‡:&quot;</span><span class="token punctuation">,</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹æ–°æ–‡æœ¬</span></span>
<span class="line">new_text <span class="token operator">=</span> <span class="token string">&quot;è¿™ä¸ªäº§å“è´¨é‡å¾ˆå¥½&quot;</span></span>
<span class="line">new_text_seg <span class="token operator">=</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>new_text<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">new_X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token punctuation">[</span>new_text_seg<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>new_X<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>new_text<span class="token punctuation">}</span></span><span class="token string">&#39; é¢„æµ‹ä¸º:&quot;</span></span><span class="token punctuation">,</span> <span class="token string">&quot;æ­£é¢&quot;</span> <span class="token keyword">if</span> pred<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token string">&quot;è´Ÿé¢&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-svm-åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#_2-svm-åˆ†ç±»"><span>2. SVM åˆ†ç±»</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒSVM</span></span>
<span class="line">clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">&#39;linear&#39;</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span></span>
<span class="line">clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹</span></span>
<span class="line">predictions <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;SVMå‡†ç¡®ç‡:&quot;</span><span class="token punctuation">,</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-æ·±åº¦å­¦ä¹ åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#_3-æ·±åº¦å­¦ä¹ åˆ†ç±»"><span>3. æ·±åº¦å­¦ä¹ åˆ†ç±»</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn</span>
<span class="line"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader<span class="token punctuation">,</span> TensorDataset</span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç®€å•çš„æ–‡æœ¬åˆ†ç±»å™¨</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">TextClassifier</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> vocab_size<span class="token punctuation">,</span> embed_dim<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>embedding <span class="token operator">=</span> nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> embed_dim<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>lstm <span class="token operator">=</span> nn<span class="token punctuation">.</span>LSTM<span class="token punctuation">(</span>embed_dim<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> batch_first<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        x <span class="token operator">=</span> self<span class="token punctuation">.</span>embedding<span class="token punctuation">(</span>x<span class="token punctuation">)</span></span>
<span class="line">        _<span class="token punctuation">,</span> <span class="token punctuation">(</span>h<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>lstm<span class="token punctuation">(</span>x<span class="token punctuation">)</span></span>
<span class="line">        out <span class="token operator">=</span> self<span class="token punctuation">.</span>fc<span class="token punctuation">(</span>h<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> out</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒè¿‡ç¨‹</span></span>
<span class="line">model <span class="token operator">=</span> TextClassifier<span class="token punctuation">(</span>vocab_size<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> embed_dim<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> num_classes<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒå¾ªç¯</span></span>
<span class="line"><span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> batch_x<span class="token punctuation">,</span> batch_y <span class="token keyword">in</span> train_loader<span class="token punctuation">:</span></span>
<span class="line">        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>batch_x<span class="token punctuation">)</span></span>
<span class="line">        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> batch_y<span class="token punctuation">)</span></span>
<span class="line">        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-è¯„ä¼°æŒ‡æ ‡" tabindex="-1"><a class="header-anchor" href="#_4-è¯„ä¼°æŒ‡æ ‡"><span>4. è¯„ä¼°æŒ‡æ ‡</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token punctuation">,</span> confusion_matrix</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è¯¦ç»†æŠ¥å‘Š</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ··æ·†çŸ©é˜µ</span></span>
<span class="line">cm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æ··æ·†çŸ©é˜µ:\\n&quot;</span><span class="token punctuation">,</span> cm<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡†ç¡®ç‡ã€å¬å›ç‡ã€F1</span></span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token punctuation">,</span> precision_score<span class="token punctuation">,</span> recall_score<span class="token punctuation">,</span> f1_score</span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‡†ç¡®ç‡:&quot;</span><span class="token punctuation">,</span> accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ç²¾ç¡®ç‡:&quot;</span><span class="token punctuation">,</span> precision_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å¬å›ç‡:&quot;</span><span class="token punctuation">,</span> recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;F1å€¼:&quot;</span><span class="token punctuation">,</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,13)),s("p",null,[n[1]||(n[1]=s("strong",null,"ä¸‹ä¸€èŠ‚ï¼š",-1)),n[2]||(n[2]=a()),c(p,{to:"/tutorials/python-ai/nlp/06-%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90.html"},{default:o(()=>[...n[0]||(n[0]=[a("æƒ…æ„Ÿåˆ†æ",-1)])]),_:1})])])}const v=t(r,[["render",k]]),b=JSON.parse('{"path":"/tutorials/python-ai/nlp/05-wenbenfenlei.html","title":"æ–‡æœ¬åˆ†ç±»","lang":"zh-CN","frontmatter":{"title":"æ–‡æœ¬åˆ†ç±»"},"headers":[{"level":2,"title":"ğŸ“š å­¦ä¹ ç›®æ ‡","slug":"ğŸ“š-å­¦ä¹ ç›®æ ‡","link":"#ğŸ“š-å­¦ä¹ ç›®æ ‡","children":[]},{"level":2,"title":"1. æœ´ç´ è´å¶æ–¯","slug":"_1-æœ´ç´ è´å¶æ–¯","link":"#_1-æœ´ç´ è´å¶æ–¯","children":[]},{"level":2,"title":"2. SVM åˆ†ç±»","slug":"_2-svm-åˆ†ç±»","link":"#_2-svm-åˆ†ç±»","children":[]},{"level":2,"title":"3. æ·±åº¦å­¦ä¹ åˆ†ç±»","slug":"_3-æ·±åº¦å­¦ä¹ åˆ†ç±»","link":"#_3-æ·±åº¦å­¦ä¹ åˆ†ç±»","children":[]},{"level":2,"title":"4. è¯„ä¼°æŒ‡æ ‡","slug":"_4-è¯„ä¼°æŒ‡æ ‡","link":"#_4-è¯„ä¼°æŒ‡æ ‡","children":[]}],"git":{"createdTime":1765249786000,"updatedTime":1765249786000,"contributors":[{"name":"CambridgeFoldingKnife","email":"3144253125@qq.com","commits":1}]},"filePathRelative":"tutorials/python-ai/nlp/05-æ–‡æœ¬åˆ†ç±».md"}');export{v as comp,b as data};
